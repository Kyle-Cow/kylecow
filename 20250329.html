<!DOCTYPE html>

<ï¼DOCTYPE html><html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¦é„°æœ‰ã€Œä½ ã€- å¿ƒä¹‹è¿·é€”</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
        }
        

<html lang=â€œzh-HKâ€>
<é ­>
<meta charset=â€œUTF-8â€>
<meta name=â€œviewportâ€ content=â€œwidth=device-widthï¼Œ initial-scale=1.0â€>
<title>å·¦é„°æœ‰ã€Œä½ ã€- å¿ƒä¹‹è¿·é€”</title>
<style>
        * {
é‚Šè·ï¼š 0;
å¡«å……ï¼š 0;
æ¡†å¤§å°ï¼š border-box;
å­—é«”ç³»åˆ—ï¼š 'Microsoft JhengHei'ï¼Œ Arialï¼Œ sans-serif;
        }

    body {
        background-color: #121212;
        color: #e0e0e0;
        line-height: 1.6;
        overflow-x: hidden;
        background-image: radial-gradient(circle at center, #1a1a2e 0%, #121212 70%);
    }
    
    .game-container {
        display: none;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        position: relative;
    }
    
    .game-title {
        text-align: center;
        font-size: 2.5rem;
        margin-bottom: 10px;
        letter-spacing: 2px;
        color: rgba(255, 255, 255, 0.9);
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }
    
    .glow {
        animation: glow 2s ease-in-out infinite alternate;
    }
    
    @keyframes glow {
        from {
            text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #4a148c, 0 0 20px #4a148c;
        }
        to {
            text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #4a148c, 0 0 40px #4a148c;
        }
    }
    
    .game-subtitle {
        text-align: center;
        font-size: 1.2rem;
        margin-bottom: 30px;
        opacity: 0.8;
    }
    
    .stage {
        display: none;
        animation: fadeIn 1s ease;
    }
    
    .stage.active {
        display: block;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .stage-title {
        font-size: 1.5rem;
        margin-bottom: 15px;
        color: #9c27b0;
        border-bottom: 1px solid rgba(156, 39, 176, 0.3);
        padding-bottom: 10px;
    }
    
    .stage-description {
        margin-bottom: 20px;
        font-size: 1.1rem;
        line-height: 1.6;
    }
    
    .story-section {
        background-color: rgba(0, 0, 0, 0.2);
        border-radius: 10px;
        padding: 15px;
        margin: 15px 0;
        position: relative;
        overflow: hidden;
    }
    
    .story-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, rgba(74, 20, 140, 0.1) 0%, rgba(0, 0, 0, 0) 100%);
        pointer-events: none;
    }
    
    .story-section.objective {
        background-color: rgba(33, 150, 243, 0.1);
        border-left: 3px solid #2196F3;
    }
    
    .story-section.note {
        background-color: rgba(255, 152, 0, 0.1);
        border-left: 3px solid #FF9800;
        font-style: italic;
    }
    
    .input-section {
        margin: 20px 0;
        text-align: center;
    }
    
    input[type="text"], input[type="password"] {
        width: 100%;
        padding: 12px;
        border: none;
        background-color: rgba(255, 255, 255, 0.1);
        color: #fff;
        border-radius: 5px;
        margin-bottom: 10px;
        font-size: 1rem;
    }
    
    input[type="text"]::placeholder, input[type="password"]::placeholder {
        color: rgba(255, 255, 255, 0.5);
    }
    
    button {
        padding: 10px 20px;
        background-color: #4a148c;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.3s ease;
    }
    
    button:hover {
        background-color: #6a1b9a;
        transform: translateY(-2px);
    }
    
    .error-message {
        color: #f44336;
        font-size: 0.9rem;
        margin-top: 5px;
        min-height: 1.5em;
    }
    
    .hint {
        font-size: 0.9rem;
        color: #aaa;
        margin-bottom: 10px;
        font-style: italic;
    }
    
    .progress-bar {
        width: 100%;
        height: 10px;
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 5px;
        overflow: hidden;
        margin-bottom: 20px;
    }
    
    .progress {
        height: 100%;
        background: linear-gradient(90deg, #4a148c 0%, #9c27b0 100%);
        width: 0%;
        transition: width 1s ease;
        box-shadow: 0 0 10px rgba(156, 39, 176, 0.7);
    }
    
    .location-guide {
        background-color: rgba(33, 150, 243, 0.15);
        border: 1px solid rgba(33, 150, 243, 0.3);
        border-radius: 10px;
        padding: 15px;
        margin: 20px 0;
        position: relative;
    }
    
    .location-title {
        color: #2196F3;
        font-size: 1.2rem;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
    }
    
    .location-icon {
        margin-right: 10px;
        font-size: 1.4rem;
    }
    
    .location-path {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
        margin-bottom: 10px;
    }
    
    .location-step {
        background-color: rgba(255, 255, 255, 0.1);
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .location-step:hover {
        background-color: rgba(33, 150, 243, 0.2);
    }
    
    .location-step.active {
        background-color: rgba(33, 150, 243, 0.3);
        font-weight: bold;
    }
    
    .location-arrow {
        color: #aaa;
        font-size: 0.8rem;
    }
    
    .location-clue {
        margin-top: 10px;
        font-style: italic;
        color: #bbb;
        font-size: 0.9rem;
    }
    
    .notebook {
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 5px;
        padding: 15px;
        margin: 30px auto;
        position: relative;
        box-shadow: 0 3px 15px rgba(0, 0, 0, 0.2);
        max-width: 90%;
        height: 250px;
        cursor: pointer;
        perspective: 1000px;
        transition: all 0.5s ease;
        z-index: 10;
    }
    
    .notebook-inner {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform 0.8s;
        transform-style: preserve-3d;
    }
    
    .notebook.flipped .notebook-inner {
        transform: rotateY(180deg);
    }
    
    .notebook-front, .notebook-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 5px;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    
    .notebook-front {
        background-color: #4a148c;
        align-items: center;
        padding: 20px;
    }
    
    .notebook-back {
        background-color: rgba(255, 255, 255, 0.05);
        transform: rotateY(180deg);
        padding: 15px;
        overflow-y: auto;
    }
    
    .notebook-title {
        color: #aaa;
        margin-bottom: 10px;
        font-size: 1.2rem;
        font-weight: normal;
        border-bottom: 1px dashed rgba(255, 255, 255, 0.2);
        padding-bottom: 5px;
    }
    
    .notebook-entry {
        margin-bottom: 10px;
        font-size: 0.95rem;
        line-height: 1.5;
        color: #ddd;
    }
    
    .notebook-highlight {
        color: #ce93d8;
        font-weight: bold;
    }
    
    .envelope-icon {
        font-size: 3rem;
        color: #fff;
    }
    
    .progress-map-container {
        position: relative;
        width: 100%;
        height: 150px;
        margin: 30px 0;
        overflow: hidden;
    }
    
    .progress-map {
        width: 100%;
        height: 100%;
    }
    
    .progress-path {
        stroke-dasharray: 1000;
        stroke-dashoffset: 1000;
        animation: drawPath 2s forwards ease-out;
    }
    
    @keyframes drawPath {
        to {
            stroke-dashoffset: 0;
        }
    }
    
    .progress-node {
        fill: #444;
        transition: all 0.5s ease;
        cursor: pointer;
    }
    
    .progress-node.current {
        fill: #9c27b0;
        filter: drop-shadow(0 0 5px rgba(156, 39, 176, 0.7));
    }
    
    .progress-node.completed {
        fill: #4caf50;
    }
    
    .progress-node.locked {
        fill: #444;
    }
    
    .progress-label {
        fill: #aaa;
        font-size: 0.7rem;
        text-anchor: middle;
        pointer-events: none;
    }
    
    .map-container {
        position: relative;
        width: 100%;
        height: 200px;
        background-color: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        margin: 20px 0;
        overflow: hidden;
        background-image: radial-gradient(circle at center, #1a1a2e 0%, #0f0f1a 100%);
    }
    
    .location {
        position: absolute;
        width: 30px;
        height: 30px;
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2;
    }
    
    .location::after {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background-color: rgba(255, 255, 255, 0.1);
        transform: scale(1);
        z-index: -1;
    }
    
    .location:hover {
        background-color: rgba(255, 255, 255, 0.2);
        transform: translate(-50%, -50%) scale(1.1);
    }
    
    .location-label {
        position: absolute;
        bottom: -20px;
        white-space: nowrap;
        font-size: 0.8rem;
        color: #aaa;
        text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
    }
    
    .location.pulse::after {
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0% { transform: scale(1); opacity: 1; }
        70% { transform: scale(2); opacity: 0; }
        100% { transform: scale(1); opacity: 0; }
    }
    
    .hidden-clue {
        position: absolute;
        visibility: hidden;
        opacity: 0;
    }
    
    .community-map {
        width: 100%;
        height: 250px;
        background-color: #1a1a2e;
        border-radius: 10px;
        margin: 20px 0;
        position: relative;
        overflow: hidden;
    }
    
    .community-building {
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .community-building:hover {
        filter: brightness(1.3);
    }
    
    .community-label {
        fill: white;
        font-size: 0.8rem;
        text-anchor: middle;
        pointer-events: none;
    }
    
    .treasure-box {
        width: 200px;
        height: 150px;
        background-color: #3e2723;
        border-radius: 10px;
        margin: 20px auto;
        position: relative;
        cursor: pointer;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        overflow: hidden;
    }
    
    .treasure-box::before {
        content: '';
        position: absolute;
        width: 80%;
        height: 10px;
        background-color: #5d4037;
        top: 40px;
        left: 10%;
        border-radius: 5px;
    }
    
    .treasure-box::after {
        content: '';
        position: absolute;
        width: 40px;
        height: 20px;
        background-color: #fbdc05;
        top: 60px;
        left: calc(50% - 20px);
        border-radius: 5px;
        box-shadow: 0 0 10px #fbdc05;
        transition: all 0.3s ease;
    }
    
    .treasure-box:hover {
        transform: scale(1.05);
    }
    
    .treasure-box.open {
        background-color: #4e342e;
    }
    
    .treasure-box.open::before {
        animation: openLid 1s forwards;
    }
    
    @keyframes openLid {
        0% { transform: rotateX(0deg); }
        100% { transform: rotateX(-90deg); opacity: 0; }
    }
    
    .treasure-box.open::after {
        animation: glowKey 1s infinite alternate;
    }
    
    @keyframes glowKey {
        from { box-shadow: 0 0 10px #fbdc05; }
        to { box-shadow: 0 0 20px #fbdc05, 0 0 40px #fbdc05; }
    }
    
    .treasure-box.shake {
        animation: shake 0.5s ease;
    }
    
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        20%, 60% { transform: translateX(-10px); }
        40%, 80% { transform: translateX(10px); }
    }
    
    .phone {
        width: 180px;
        height: 300px;
        background-color: #000;
        border-radius: 20px;
        margin: 20px auto;
        position: relative;
        padding: 15px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
    }
    
    .phone-screen {
        width: 100%;
        height: 85%;
        background-color: #121212;
        border-radius: 10px;
        overflow-y: auto;
        padding: 10px;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    
    .phone-button {
        width: 40px;
        height: 40px;
        background-color: #333;
        border-radius: 50%;
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .phone-button:hover {
        background-color: #444;
    }
    
    .message {
        padding: 8px 12px;
        border-radius: 15px;
        max-width: 80%;
        word-break: break-word;
        font-size: 0.9rem;
        animation: messageIn 0.3s ease;
    }
    
    @keyframes messageIn {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }
    
    .message.incoming {
        background-color: #263238;
        align-self: flex-start;
        border-bottom-left-radius: 5px;
    }
    
    .message.outgoing {
        background-color: #4a148c;
        align-self: flex-end;
        border-bottom-right-radius: 5px;
    }
    
    .inventory {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin: 20px 0;
        justify-content: center;
    }
    
    .food-item {
        width: 80px;
        padding: 10px;
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        text-align: center;
        transition: all 0.3s ease;
        cursor: pointer;
    }
    
    .food-item:hover {
        transform: translateY(-5px);
        background-color: rgba(255, 255, 255, 0.15);
    }
    
    .food-img {
        font-size: 2rem;
        margin-bottom: 5px;
    }
    
    .effect-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 100;
        overflow: hidden;
    }
    
    .sparkle {
        position: absolute;
        width: 8px;
        height: 8px;
        background-color: #fff;
        border-radius: 50%;
        box-shadow: 0 0 10px #fff, 0 0 20px #fff;
        animation: fadeOut 1s forwards;
    }
    
    @keyframes fadeOut {
        to { opacity: 0; transform: scale(0); }
    }
    
    .confetti {
        position: absolute;
        width: 10px;
        height: 10px;
        opacity: 1;
        animation: fall 3s forwards linear;
    }
    
    @keyframes fall {
        to { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }
    
    .achievements {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
        margin: 15px 0;
    }
    
    .achievement {
        width: 80px;
        height: 80px;
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        transition: all 0.3s ease;
        font-size: 2rem;
        opacity: 0.3;
    }
    
    .achievement.unlocked {
        background-color: rgba(255, 215, 0, 0.2);
        box-shadow: 0 0 15px gold;
        opacity: 1;
    }
    
    .achievement-label {
        position: absolute;
        bottom: -25px;
        left: 50%;
        transform: translateX(-50%);
        white-space: nowrap;
        font-size: 0.8rem;
        color: #aaa;
    }
    
    .achievement.unlocked .achievement-label {
        color: gold;
    }
    
    .money-collection {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin: 20px 0;
        justify-content: center;
    }
    
    .money-item {
        width: 80px;
        height: 80px;
        background-color: #fbdc05;
        border-radius: 50%;
        color: #000;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 0 10px rgba(251, 220, 5, 0.5);
        transition: all 0.3s ease;
        cursor: pointer;
    }
    
    .money-item:hover {
        transform: translateY(-5px) rotate(10deg);
        box-shadow: 0 0 15px rgba(251, 220, 5, 0.7);
    }
    
    .money-value {
        font-size: 1.5rem;
    }
    
    .eerie-effect {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at center, transparent 0%, rgba(0, 0, 0, 0.5) 100%);
        pointer-events: none;
        z-index: 0;
    }
    
    .void-circle {
        position: absolute;
        border-radius: 50%;
        border: 2px solid rgba(255, 255, 255, 0.1);
        background-color: rgba(0, 0, 0, 0.2);
        transform: translate(-50%, -50%);
        animation: pulse-void 4s infinite alternate;
    }
    
    @keyframes pulse-void {
        0% { box-shadow: 0 0 10px rgba(74, 20, 140, 0.3); }
        100% { box-shadow: 0 0 30px rgba(74, 20, 140, 0.7); }
    }
    
    .void-heart {
        position: relative;
        width: 100px;
        height: 100px;
        margin: 20px auto;
    }
    
    .void-heart::before, .void-heart::after {
        content: '';
        position: absolute;
        width: 50px;
        height: 80px;
        border: 2px solid #4a148c;
        border-radius: 50px 50px 0 0;
        background-color: transparent;
    }
    
    .void-heart::before {
        transform: rotate(-45deg);
        left: 20px;
    }
    
    .void-heart::after {
        transform: rotate(45deg);
        right: 20px;
    }
    
    .void-heart.filling::before, .void-heart.filling::after {
        background-color: rgba(74, 20, 140, 0.3);
        animation: fill-heart 2s forwards;
    }
    
    @keyframes fill-heart {
        0% { background-color: rgba(74, 20, 140, 0); }
        100% { background-color: rgba(74, 20, 140, 0.7); }
    }
    
    .fog {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxmaWx0ZXIgaWQ9ImZvZyI+PGZlVHVyYnVsZW5jZSB0eXBlPSJmcmFjdGFsTm9pc2UiIGJhc2VGcmVxdWVuY3k9IjAuMDEiIG51bU9jdGF2ZXM9IjUiIHN0aXRjaFRpbGVzPSJzdGl0Y2giIHJlc3VsdD0ibm9pc2UiIC8+PGZlQ29sb3JNYXRyaXggaW49Im5vaXNlIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMSAwIDAgMCAwIDAgMSAwIDAgMCAwIDAgMSAwIDAgMCAwIDAgMC4xIDAiIHJlc3VsdD0iZm9nIiAvPjwvZmlsdGVyPjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ0cmFuc3BhcmVudCIgZmlsdGVyPSJ1cmwoI2ZvZykiIC8+PC9zdmc+');
        opacity: 0.3;
        pointer-events: none;
        z-index: 1;
    }
    
    .dialogue-container {
        position: relative;
        padding: 10px 15px;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 8px;
        font-size: 1rem;
        margin: 15px 0;
        text-align: left;
        max-height: 0;
        overflow: hidden;
        opacity: 0;
        transition: all 0.5s ease;
    }
    
    .dialogue-container.show {
        max-height: 300px;
        opacity: 1;
        margin: 15px 0;
    }
    
    .dialogue-text {
        margin: 5px 0;
        color: #fff;
    }
    
    .dialogue-name {
        color: #9c27b0;
        font-weight: bold;
        margin-right: 10px;
    }
    
    .typing-effect {
        overflow: hidden;
        white-space: nowrap;
        border-right: 2px solid #fff;
        animation: typing 3s steps(40, end), blink-caret 0.75s step-end infinite;
    }
    
    @keyframes typing {
        from { width: 0 }
        to { width: 100% }
    }
    
    @keyframes blink-caret {
        from, to { border-color: transparent }
        50% { border-color: #fff }
    }
    
    .cutscene {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.85);
        z-index: 1000;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 20px;
        opacity: 0;
        visibility: hidden;
        transition: all 0.5s ease;
    }
    
    .cutscene.active {
        opacity: 1;
        visibility: visible;
    }
    
    .cutscene-content {
        max-width: 800px;
        text-align: center;
    }
    
    .cutscene-title {
        font-size: 2rem;
        margin-bottom: 20px;
        color: #fff;
        text-shadow: 0 0 10px rgba(156, 39, 176, 0.7);
    }
    
    .cutscene-text {
        font-size: 1.2rem;
        line-height: 1.6;
        margin-bottom: 30px;
        color: #eee;
    }
    
    .cutscene-continue {
        font-size: 1rem;
        color: #aaa;
        margin-top: 30px;
        animation: pulse 1s infinite alternate;
    }
    
    .envelope-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.9);
        z-index: 1500;
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.5s ease;
    }
    
    .envelope-container.active {
        opacity: 1;
        visibility: visible;
    }
    
    .envelope-svg {
        width: 300px;
        height: 200px;
        position: relative;
        perspective: 1000px;
    }
    
    .envelope-body {
        fill: #4a148c;
        stroke: #6a1b9a;
        stroke-width: 2;
        filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.5));
    }
    
    .envelope-flap {
        fill: #6a1b9a;
        transform-origin: center top;
        transition: transform 2s ease;
    }
    
    .envelope-container.opening .envelope-flap {
        transform: rotateX(180deg);
    }
    
    .envelope-letter {
        position: absolute;
        width: 260px;
        height: 160px;
        background: white;
        border-radius: 5px;
        top: 20px;
        left: 20px;
        padding: 15px;
        transform: translateY(0);
        transition: transform 1s ease;
        z-index: -1;
        color: #333;
        font-size: 0.9rem;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
    
    .envelope-container.opening .envelope-letter {
        transform: translateY(-100px);
        z-index: 1;
    }
    
    .letter-title {
        font-size: 1.2rem;
        margin-bottom: 10px;
        color: #4a148c;
        font-weight: bold;
    }
    
    .letter-content {
        text-align: center;
        line-height: 1.4;
    }
    
    .envelope-glow {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        background: radial-gradient(circle at center, rgba(156, 39, 176, 0.3) 0%, transparent 70%);
        filter: blur(10px);
        animation: envelope-pulse 2s infinite alternate;
    }
    
    @keyframes envelope-pulse {
        from { opacity: 0.5; }
        to { opacity: 1; }
    }
    
    .key-effect {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        opacity: 0;
        transition: opacity 0.5s ease, transform 1s ease;
    }

    .key-effect.show {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1.5);
    }
    
    .start-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #121212;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 2000;
        background-image: radial-gradient(circle at center, #1a1a2e 0%, #121212 70%);
    }

    .start-screen .game-title {
        font-size: 3rem;
        margin-bottom: 20px;
    }

    .start-screen .game-subtitle {
        font-size: 1.5rem;
        margin-bottom: 30px;
    }

    .start-screen button {
        padding: 15px 30px;
        font-size: 1.2rem;
        background-color: #4a148c;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .start-screen button:hover {
        background-color: #6a1b9a;
        transform: scale(1.1);
    }

    .hint-card {
        position: relative;
        max-height: 0;
        overflow: hidden;
        opacity: 0;
        transition: all 0.5s ease;
    }
    
    .hint-card.show {
        max-height: 300px;
        opacity: 1;
        margin: 15px 0;
    }
    
    .hint-btn {
        background-color: rgba(33, 150, 243, 0.2);
        color: #2196F3;
        border: 1px solid #2196F3;
        margin-top: 5px;
    }
    
    .hint-btn:hover {
        background-color: rgba(33, 150, 243, 0.3);
    }
</style>

</head>
<body>
    <div class="eerie-effect"></div>
    <div class="fog"></div>
    

</é ­>
<èº«é«”>
<div class=â€œeerie-effectâ€></div>
<div class=â€œfogâ€></div>

<div class="start-screen">
    <h1 class="game-title glow">å·¦é„°æœ‰ã€Œä½ ã€</h1>
    <p class="game-subtitle">å°‹æ‰¾å¿ƒä¹‹é–åŒ™</p>
    <button id="gameStartBtn">Game Start</button>
</div>

<div class="game-container">
    <h1 class="game-title glow">å·¦é„°æœ‰ã€Œä½ ã€</h1>
    <p class="game-subtitle">å°‹æ‰¾å¿ƒä¹‹é–åŒ™</p>
    
    <div class="progress-bar">
        <div class="progress" id="progressBar"></div>
    </div>
    
    <!-- ä¿¡å°å‹•ç•«å®¹å™¨ -->
    <div class="envelope-container" id="envelope-container">
        <div class="envelope-glow"></div>
        <svg class="envelope-svg" viewBox="0 0 300 200">
            <rect class="envelope-body" x="20" y="50" width="260" height="150" rx="5"/>
            <path class="envelope-flap" d="M20,50 L150,120 L280,50 L280,50 L150,20 L20,50 Z"/>
            <path class="envelope-fold" d="M20,50 L150,120 L20,200" fill="none" stroke="#6a1b9a" stroke-width="1" opacity="0.5"/>
            <path class="envelope-fold" d="M280,50 L150,120 L280,200" fill="none" stroke="#6a1b9a" stroke-width="1" opacity="0.5"/>
        </svg>
        <div class="envelope-letter" id="envelope-letter">
            <h3 class="letter-title" id="letter-title">å¿ƒä¹‹è¿·é€”</h3>
            <p class="letter-content" id="letter-content">ä½ é†’ä¾†æ–¼ä¸€å€‹ç†Ÿæ‚‰åˆé™Œç”Ÿçš„ç©ºé–“ï¼Œé€™è£¡åƒæ˜¯ç¤¾å€çš„å€’å½±ï¼Œå»ç± ç½©è‘—è©­ç•°çš„æ°›åœã€‚æ›´å¥‡æ€ªçš„æ˜¯ï¼Œä½ æ„Ÿè¦ºä¸åˆ°ä»»ä½•æƒ…æ„Ÿï¼Œå¦‚åŒå¿ƒæ˜¯ç©ºæ´çš„ã€‚</p>
        </div>
    </div>
    
    <!-- éå ´å‹•ç•«å®¹å™¨ -->
    <div class="cutscene" id="cutscene">
        <div class="cutscene-content">
            <h2 class="cutscene-title" id="cutscene-title"></h2>
            <p class="cutscene-text" id="cutscene-text"></p>
            <p class="cutscene-continue">é»æ“Šä»»æ„è™•ç¹¼çºŒ...</p>
        </div>
    </div>
    
    <!-- é€²ç¨‹åœ°åœ– -->
    <div class="progress-map-container">
        <svg class="progress-map" viewBox="0 0 800 100" preserveAspectRatio="xMidYMid meet">
            <path class="progress-path" d="M50,50 C150,20 250,80 350,50 C450,20 550,80 650,50 S750,20 750,50" 
                stroke="#444" stroke-width="10" fill="none" stroke-linecap="round"/>
            <circle class="progress-node current" id="node0" cx="50" cy="50" r="10"/>
            <text class="progress-label" x="50" y="75">å–„åŒ¯</text>
            <circle class="progress-node locked" id="node1" cx="190" cy="30" r="10"/>
            <text class="progress-label" x="190" y="15">äº¤é€šè·¯ç·š</text>
            <circle class="progress-node locked" id="node2" cx="350" cy="50" r="10"/>
            <text class="progress-label" x="350" y="75">é¤å»³</text>
            <circle class="progress-node locked" id="node3" cx="480" cy="30" r="10"/>
            <text class="progress-label" x="480" y="15">ç¤¾å€ä¸­å¿ƒ</text>
            <circle class="progress-node locked" id="node4" cx="580" cy="70" r="10"/>
            <text class="progress-label" x="580" y="95">å…¬åœ’</text>
            <circle class="progress-node locked" id="node5" cx="680" cy="40" r="10"/>
            <text class="progress-label" x="680" y="25">å®¶èˆˆ</text>
            <circle class="progress-node locked" id="node6" cx="750" cy="50" r="10"/>
            <text class="progress-label" x="750" y="75">è¡—å¸‚</text>
        </svg>
    </div>
    
    <!-- éŠæˆ²ä»‹ç´¹ -->
    <div class="stage active" id="intro">
        <h2 class="stage-title">ç•°ç©ºé–“----ç†Ÿæ‚‰çš„é™Œç”Ÿåœ°</h2>
        <div class="notebook" id="notebook-intro">
            <div class="notebook-inner">
                <div class="notebook-front">
                    <div class="envelope-icon">âœ‰ï¸</div>
                </div>
                <div class="notebook-back">
                    <h3 class="notebook-title">è¿·é€”ç­†è¨˜</h3>
                    <p class="notebook-entry">æˆ‘ä¼¼ä¹è¢«å›°åœ¨ä¸€å€‹ç†Ÿæ‚‰åˆé™Œç”Ÿçš„ç©ºé–“ï¼Œç¤¾å€çš„è¼ªå»“ä¾ç¨€å¯è¦‹ï¼Œä½†ä¸€åˆ‡éƒ½ç± ç½©è‘—è©­ç•°çš„æ°›åœã€‚æœ€å¥‡æ€ªçš„æ˜¯ï¼Œæˆ‘æ„Ÿè¦ºä¸åˆ°ä»»ä½•æƒ…æ„Ÿï¼Œå¦‚åŒå¿ƒæ˜¯ç©ºæ´çš„ã€‚</p>
                    <p class="notebook-entry">ç¥ç§˜è²éŸ³æåˆ°äº†<span class="notebook-highlight">å¿ƒä¹‹é–åŒ™</span>ï¼Œä¼¼ä¹åªæœ‰æ‰¾åˆ°å®ƒï¼Œæˆ‘å’Œå…¶ä»–å±…æ°‘æ‰èƒ½æ¢å¾©ã€‚æˆ‘éœ€è¦è·Ÿéš¨<span class="notebook-highlight">è¨˜æ†¶ç¢ç‰‡</span>é–‹å§‹é€™æ®µå¥‡ç•°çš„æ—…ç¨‹ã€‚</p>
                </div>
            </div>
        </div>
        <div class="dialogue-container show" id="intro-dialogue">
            <p class="dialogue-text typing-effect"><span class="dialogue-name">ç¥ç§˜è²éŸ³:</span>æ­¡è¿ä¾†åˆ°ã€å¿ƒä¹‹è¿·é€”ã€ã€‚ä½ ï¼Œé‚„æœ‰å…¶ä»–æ‰€æœ‰å±…æ°‘ï¼Œéƒ½å¤±å»äº†è‡ªå·±çš„ã€å¿ƒä¹‹é–åŒ™ã€ã€‚æ²’æœ‰å®ƒï¼Œä½ å€‘çš„å¿ƒå°‡æ°¸é æ˜¯ç©ºæ´çš„...</p>
        </div>
        <div class="story-section">
            <p>ä½ é†’ä¾†ç™¼ç¾è‡ªå·±èº«è™•ä¸€å€‹ç†Ÿæ‚‰åˆé™Œç”Ÿçš„ç©ºé–“ï¼Œå½·å½¿æ˜¯ä½ æ›¾ç¶“ç”Ÿæ´»çš„ç¤¾å€ï¼Œå»åˆå¾®å¦™åœ°ä¸åŒã€‚å‘¨åœçš„ä¸€åˆ‡éƒ½ç± ç½©è‘—ä¸€å±¤è©­ç•°çš„æ°›åœï¼Œè€Œæ›´å¥‡æ€ªçš„æ˜¯ï¼Œä½ æ„Ÿè¦ºè‡ªå·±çš„å¿ƒæ˜¯ç©ºæ´çš„ã€‚</p>
        </div>
        <div class="void-heart" id="introHeart"></div>
        <div class="story-section objective">
            <p><strong>ä»»å‹™ç›®æ¨™ï¼š</strong>æ¢ç´¢é€™å€‹è©­ç•°çš„ç©ºé–“ï¼Œè§£é–‹è¬é¡Œï¼Œå°‹æ‰¾å¤±è½çš„è¨˜æ†¶ç¢ç‰‡ï¼Œæ‰¾å›ä½ å’Œå±…æ°‘çš„ã€Œå¿ƒä¹‹é–åŒ™ã€ã€‚</p>
        </div>
        <div class="location-guide">
            <h3 class="location-title"><span class="location-icon">ğŸ“</span>ç•¶å‰ä½ç½®</h3>
            <div class="location-path">
                <div class="location-step active">å–„åŒ¯</div>
            </div>
            <p class="location-clue">å°‹æ‰¾å¿ƒä¹‹é–åŒ™çš„æ—…ç¨‹å¾é€™è£¡é–‹å§‹ï¼Œä½ éœ€è¦å‰å¾€äº¤é€šè·¯ç·šå°‹æ‰¾ç¬¬ä¸€å€‹ç·šç´¢ã€‚</p>
        </div>
        <div class="map-container">
            <div class="location" style="top: 30%; left: 25%">
                <span class="location-label">å·´å£«ç«™</span>
            </div>
            <div class="location" style="top: 50%; left: 60%">
                <span class="location-label">åœ°éµç«™</span>
            </div>
            <div class="location" style="top: 70%; left: 40%">
                <span class="location-label">å°å·´ç«™</span>
            </div>
            <div class="void-circle" style="top: 30%; left: 25%; width: 40px; height: 40px;"></div>
            <div class="hidden-clue">é›»è©±å¯†ç¢¼è—åœ¨æ•¸å­—ï¼š999</div>
        </div>
        <div class="input-section">
            <button id="startBtn">å‰å¾€äº¤é€šè·¯ç·š</button>
        </div>
    </div>
    
    <!-- ç¬¬ä¸€é—œï¼šäº¤é€šè·¯ç·š -->
    <div class="stage" id="stage1">
        <h2 class="stage-title">ç¬¬ä¸€é—œï¼šäº¤é€šå¯†ç¢¼</h2>
        <div class="story-section">
            <p>ä½ ä¾†åˆ°ç¤¾å€çš„äº¤é€šè·¯ç·šï¼Œå‘¨åœé£„æ•£è‘—æ¨¡ç³Šçš„æ•¸å­—ç¢ç‰‡ã€‚é€™äº›ç¢ç‰‡ä¼¼ä¹çµ„æˆäº†æŸå€‹ç‰¹æ®Šçš„å¯†ç¢¼ï¼Œå¯èƒ½èˆ‡å–„åŒ¯è·å“¡æœ‰é—œã€‚</p>
            <p>ã€Œå‘¢çµ„å¯†ç¢¼ä¿‚å’©?ã€ä½ è‡ªè¨€è‡ªèªåœ°æ€è€ƒè‘—ã€‚</p>
            <p>ã€Œé€™äº›æ•¸å­—ä¼¼ä¹åœ¨å·´å£«ç«™æœ‰é—œï¼Œéœ€è¦å®Œæˆä»»å‹™æ‰¾åˆ°å¯†ç¢¼ï¼Ÿã€</p>
        </div>
        <div class="dialogue-container show" id="stage1-dialogue">
            <p class="dialogue-text"><span class="dialogue-name">ä½ :</span>é€™äº›é£„æ•£çš„æ•¸å­—...åƒæ˜¯æŸç¨®å¯†ç¢¼ï¼Œå·´å£«ç«™å‘¨åœçš„æ•¸å­—æ ¼å¤–æ¸…æ™°ã€‚</p>
        </div>
        <div class="location-guide">
            <h3 class="location-title"><span class="location-icon">ğŸ“</span>ç•¶å‰ä½ç½®</h3>
            <div class="location-path">
                <div class="location-step">å–„åŒ¯</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step active">äº¤é€šè·¯ç·š</div>
            </div>
            <p class="location-clue">æ•¸å­—å¯†ç¢¼å¯èƒ½æ˜¯æŸå€‹é›»è©±è™Ÿç¢¼ï¼Œå°‹æ‰¾äº¤é€šè·¯ç·šä¸­éš±è—çš„ä¸‰ä½æ•¸å­—ç·šç´¢ã€‚</p>
        </div>
        <div class="story-section objective">
            <p><strong>ç›®æ¨™ï¼š</strong>æ”¶é›†é£„æ•£çš„æ•¸å­—ç¢ç‰‡ï¼Œæ‹¼æ¹Šå‡ºä¸€å€‹ä¸‰ä½æ•¸å¯†ç¢¼ã€‚</p>
        </div>
        <div class="map-container">
            <div class="location" style="top: 30%; left: 25%">
                <span class="location-label">å·´å£«ç«™</span>
            </div>
            <div class="location" style="top: 50%; left: 60%">
                <span class="location-label">åœ°éµç«™</span>
            </div>
            <div class="location" style="top: 70%; left: 40%">
                <span class="location-label">å°å·´ç«™</span>
            </div>
            <div class="void-circle" style="top: 30%; left: 25%; width: 40px; height: 40px;"></div>
            <div class="hidden-clue">é›»è©±å¯†ç¢¼è—åœ¨æ•¸å­—ï¼š999</div>
        </div>
        <div class="input-section">
            <p class="hint">æç¤ºï¼šå°‹æ‰¾é£„æµ®åœ¨å·´å£«ç«™å‘¨åœçš„æ•¸å­—</p>
            <input type="text" id="stage1Input" placeholder="è¼¸å…¥ç™¼ç¾çš„æ•¸å­—...">
            <button id="stage1Btn">ç¢ºèª</button>
            <p class="error-message" id="stage1Error"></p>
        </div>
        <div class="key-effect" style="display: none;">
            <svg width="50" height="50" viewBox="0 0 50 50">
                <path d="M10 10 L20 20 M20 10 L10 20" stroke="#fbdc05" stroke-width="2"/>
            </svg>
        </div>
        <div class="hint-card" id="hint1">
            <p>é›†ä¸­æ³¨æ„åŠ›çœ‹å·´å£«ç«™å‘¨åœï¼Œé‚£è£¡æœ‰ä¸‰å€‹ç›¸åŒçš„æ•¸å­—é‡è¤‡å‡ºç¾ã€‚é€™å †æ•¸å­—åœ¨ç©ºä¸­é‡æ•´ï¼Œå½¢æˆã€Œå¯†ç¢¼ã€ï¼Œä¸¦è«‹å‰å¾€ç†Ÿæ‚‰çš„é¤å»³!!</p>
        </div>
        <button class="hint-btn" id="showHint1">éœ€è¦æç¤ºï¼Ÿ</button>
    </div>
    
    <!-- ç¬¬äºŒé—œï¼šé¤å»³ -->
    <div class="stage" id="stage2">
        <h2 class="stage-title">ç¬¬äºŒé—œï¼šç¥ç§˜é€šè¨Š</h2>
        <div class="story-section">
            <p>ç•¶ä½ ä¾†åˆ°ä¸€å®¶é¤å»³ï¼Œè«‹å³åˆ»å®Œæˆä»»å‹™ã€‚</p>
            <p>ã€Œå””é€šè¦æ‰“æ¯”é›»è©±ä¸­æ—¢äººå•ä½¢ä¿‚é‚Šå€‹?ã€ä½ å¿ƒæƒ³ï¼Œé€™ä¼¼ä¹æ˜¯å”¯ä¸€çš„è¾¦æ³•äº†ã€‚</p>
        </div>
        <div class="dialogue-container show" id="stage2-dialogue">
            <p class="dialogue-text"><span class="dialogue-name">é™Œç”Ÿäºº:</span>é€™éƒ¨æ‰‹æ©Ÿå¥½åƒå¾ˆé‡è¦...ä¸Šé¢çš„è™Ÿç¢¼ã€Œ999ã€ï¼Œæˆ–è¨±èƒ½é€£æ¥åˆ°æŸäººã€‚</p>
        </div>
        <div class="location-guide">
            <h3 class="location-title"><span class="location-icon">ğŸ“</span>ç•¶å‰ä½ç½®</h3>
            <div class="location-path">
                <div class="location-step">å–„åŒ¯</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">äº¤é€šè·¯ç·š</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step active">é¤å»³</div>
            </div>
            <p class="location-clue">ä½ çš„ä¸‹ä¸€ç«™å¯èƒ½æ˜¯ç¤¾å€ä¸­å¿ƒï¼Œä½†éœ€è¦å…ˆé€šéé›»è©±èˆ‡æ˜Œæºé€šã€‚</p>
        </div>
        <div class="story-section objective">
            <p><strong>ç›®æ¨™ï¼š</strong>æ‹†è§£é›»è©±å¯†ç¢¼ï¼Œè‡´é›»ä»–å•ä¸‹ç™¼ç”Ÿå’©äº‹</p>
        </div>
        <div class="phone">
            <div class="phone-screen" id="phoneScreen"></div>
            <div class="phone-button" id="phoneButton"></div>
        </div>
        <div class="story-section note">
            <p>é¤å»³ä¸­çš„é™Œç”Ÿäººçµ¦äº†ä½ ä¸€éƒ¨æ‰‹æ©Ÿï¼Œä½ æ³¨æ„åˆ°å·²ç¶“æœ‰ä¸€å€‹è™Ÿç¢¼ã€Œ999ã€è¼¸å…¥åœ¨æ’¥è™Ÿä»‹é¢ä¸Šã€‚ç¾åœ¨ä½ éœ€è¦è©¢å•æ¥é›»è©±çš„äººæ˜¯èª°ã€‚</p>
        </div>
        <div class="input-section">
            <p class="hint">æç¤ºï¼šå‘æ¥é›»è©±çš„äººè©¢å•ä»–çš„èº«ä»½</p>
            <input type="text" id="stage2Input" placeholder="è¼¸å…¥ä½ è¦å•çš„è©±...">
            <button id="stage2Btn">ç™¼é€</button>
            <p class="error-message" id="stage2Error"></p>
        </div>
        <div class="key-effect" style="display: none;">
            <svg width="50" height="50" viewBox="0 0 50 50">
                <path d="M10 10 L20 20 M20 10 L10 20" stroke="#fbdc05" stroke-width="2"/>
            </svg>
        </div>
        <div class="hint-card" id="hint2">
            <p>å˜—è©¦æœ€ç›´æ¥çš„å•é¡Œï¼Œä¾‹å¦‚ã€Œä½ æ˜¯èª°ã€æˆ–ã€Œä½ ä¿‚é‚Šå€‹ã€ä¾†ç¢ºèªå°æ–¹çš„èº«ä»½ã€‚</p>
        </div>
        <button class="hint-btn" id="showHint2">éœ€è¦æç¤ºï¼Ÿ</button>
    </div>
    
    <!-- ç¬¬ä¸‰é—œï¼šç¤¾å€ä¸­å¿ƒ -->
    <div class="stage" id="stage3">
        <h2 class="stage-title">ç¬¬ä¸‰é—œï¼šç¤¾å€æ´»å‹•</h2>
        <div class="story-section">
            <p>é€šéèˆ‡æ˜Œçš„äº¤æµï¼Œä½ è¢«å¼•å°åˆ°ç¤¾å€ä¸­å¿ƒï¼Œé€™è£¡æœ‰è¨±å¤šæ´»å‹•å’Œä¼‘æ†©ç©ºé–“ã€‚ä½ éœ€è¦æ‰¾å‡ºç¤¾å€ä¸­æœ€ç‰¹åˆ¥çš„åœ°æ–¹ä»¥ç¹¼çºŒä½ çš„æ—…ç¨‹ã€‚</p>
            <p>ã€Œé™¤å·¦åˆ°ç¤¾å€ä¸­å¿ƒç™¼ç¾åŸä¾†æœ‰å¥½å¤šæ´»å‹•ï¼Œå¸‚æ°‘éƒ½æœƒå¹³æ™‚å»çš„åœ°æ–¹ï¼Œå””é€šæœåº¦æœ‰å’©ç‰¹åˆ¥?ã€ä½ æ€è€ƒè‘—ã€‚</p>
        </div>
        <div class="dialogue-container show" id="stage3-dialogue">
            <p class="dialogue-text"><span class="dialogue-name">æ˜Œ:</span>ç¤¾å€ä¸­å¿ƒæœ‰å€‹ç‰¹åˆ¥çš„åœ°æ–¹ï¼Œé‚£è£¡æ˜¯è¨±å¤šå±…æ°‘å¿ƒéˆçš„ä¼‘æ†©è™•ã€‚æ‰¾åˆ°é‚£è£¡ï¼Œä½ æœƒæ›´æ¥è¿‘ç­”æ¡ˆã€‚</p>
        </div>
        <div class="location-guide">
            <h3 class="location-title"><span class="location-icon">ğŸ“</span>ç•¶å‰ä½ç½®</h3>
            <div class="location-path">
                <div class="location-step">å–„åŒ¯</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">äº¤é€šè·¯ç·š</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">é¤å»³</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step active">ç¤¾å€ä¸­å¿ƒ</div>
            </div>
            <p class="location-clue">æ¢ç´¢ç¤¾å€ä¸­å¿ƒçš„å„å€‹ç©ºé–“ï¼Œç‰¹åˆ¥æ˜¯ç¶“å¸¸èˆ‰è¾¦æ´»å‹•çš„åœ°æ–¹ã€‚</p>
        </div>
        <div class="story-section objective">
            <p><strong>ç›®æ¨™ï¼š</strong>æ‰¾å‡ºç¤¾å€ä¸­å¿ƒä¸­æœ€é‡è¦çš„æ´»å‹•å ´æ‰€ã€‚</p>
        </div>
        <div class="community-map" id="communityMap">
            <svg width="100%" height="100%" viewBox="0 0 500 250">
                <rect x="0" y="0" width="500" height="250" fill="#1a1a2e"/>
                <path d="M50,125 L450,125 M250,50 L250,200" stroke="#303050" stroke-width="15" stroke-dasharray="10 5"/>
                <g class="community-building" id="activityRoom">
                    <rect x="80" y="30" width="80" height="60" fill="none" stroke="#505080" stroke-width="2" stroke-dasharray="5 3"/>
                    <text class="community-label" x="120" y="65">æ´»å‹•å®¤</text>
                </g>
                <g class="community-building" id="infoCenter">
                    <rect x="210" y="100" width="80" height="60" fill="none" stroke="#505080" stroke-width="2" stroke-dasharray="5 3"/>
                    <text class="community-label" x="250" y="135">è³‡è¨Šè™•</text>
                </g>
                <g class="community-building pulse" id="restArea">
                    <rect x="340" y="170" width="80" height="60" fill="none" stroke="#9050a0" stroke-width="2"/>
                    <text class="community-label" x="380" y="205">å…¬åœ’</text>
                </g>
            </svg>
        </div>
        <div class="input-section">
            <p class="hint">æç¤ºï¼šå°‹æ‰¾ç¤¾å€ä¸­å¿ƒè£¡ç‰¹åˆ¥é¡¯çœ¼æˆ–ç™¼å…‰çš„å€åŸŸ</p>
            <input type="text" id="stage3Input" placeholder="è¼¸å…¥ç‰¹æ®Šçš„åœ°é»...">
            <button id="stage3Btn">ç¢ºèª</button>
            <p class="error-message" id="stage3Error"></p>
        </div>
        <div class="key-effect" style="display: none;">
            <svg width="50" height="50" viewBox="0 0 50 50">
                <path d="M10 10 L20 20 M20 10 L10 20" stroke="#fbdc05" stroke-width="2"/>
            </svg>
        </div>
        <div class="hint-card" id="hint3">
            <p>æ³¨æ„åœ°åœ–ä¸Šå”¯ä¸€æœ‰é¡è‰²é‚Šæ¡†å’Œè„ˆè¡æ•ˆæœçš„å€åŸŸã€‚ã€Œå…¬åœ’ã€æ˜¯ç¤¾å€ä¸­æœ€æ´»èºçš„åœ°æ–¹ã€‚</p>
        </div>
        <button class="hint-btn" id="showHint3">éœ€è¦æç¤ºï¼Ÿ</button>
    </div>
    
    <!-- ç¬¬å››é—œï¼šå…¬åœ’ -->
    <div class="stage" id="stage4">
        <h2 class="stage-title">ç¬¬å››é—œï¼šç¥ç§˜å¯¶ç®±</h2>
        <div class="story-section">
            <p>å…¬åœ’çš„ç·šç´¢å¼•å°ä½ ä¾†åˆ°å…¬åœ’ï¼Œåœ¨è‰å¢ä¸­ç™¼ç¾äº†ä¸€å€‹ç¥ç§˜çš„å¯¶ç®±ï¼Œè£¡é¢ä¼¼ä¹è—è‘—æ–°çš„è¬é¡Œå’Œé›¶é£Ÿæç¤ºã€‚</p>
            <p>ã€Œå¾—åˆ°åœ°åœ–å‰å¾€å¥½å¤šé›¶é£Ÿèˆ‡æ—¥ç”¨å“çš„æé†’ç´™ï¼ŒåŒä¸€å †éŒ¢? å””é€šè¦è²·Då’©å»æ”¶è²·äºº?ã€ä½ é©šè¨åœ°çœ‹è‘—å¯¶ç®±ä¸­çš„å…§å®¹ã€‚</p>
        </div>
        <div class="dialogue-container show" id="stage4-dialogue">
            <p class="dialogue-text"><span class="dialogue-name">å°å­©:</span>é‚£å€‹å¯¶ç®±å¾ˆç‰¹åˆ¥ï¼Œåªæœ‰çŸ¥é“å¯†ç¢¼çš„äººæ‰èƒ½æ‰“é–‹ã€‚äººå€‘èªªå¯†ç¢¼æ˜¯æœ€åŸºæœ¬çš„é †åºæ•¸å­—ã€‚</p>
        </div>
        <div class="location-guide">
            <h3 class="location-title"><span class="location-icon">ğŸ“</span>ç•¶å‰ä½ç½®</h3>
            <div class="location-path">
                <div class="location-step">å–„åŒ¯</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">äº¤é€šè·¯ç·š</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">é¤å»³</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">ç¤¾å€ä¸­å¿ƒ</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step active">å…¬åœ’</div>
            </div>
            <p class="location-clue">å¯¶ç®±ä¸­çš„éŒ¢å’Œé›¶é£Ÿæç¤ºæŒ‡å‘ä¸‹ä¸€å€‹ç›®çš„åœ°ã€‚</p>
        </div>
        <div class="story-section objective">
            <p><strong>ç›®æ¨™ï¼š</strong>æ‰¾å‡ºé–‹å•Ÿå¯¶ç®±çš„å¯†ç¢¼ï¼Œæ­é–‹ç®±ä¸­è¬é¡Œã€‚</p>
        </div>
        <div class="treasure-box" id="treasureBox"></div>
        <div class="money-collection">
            <div class="money-item">
                <span class="money-value">$10</span>
            </div>
            <div class="money-item">
                <span class="money-value">$20</span>
            </div>
            <div class="money-item">
                <span class="money-value">$50</span>
            </div>
            <div class="money-item">
                <span class="money-value">$100</span>
            </div>
        </div>
        <div class="story-section note">
            <p>å¯¶ç®±è¡¨é¢é–ƒçˆè‘—å¾®å¼±çš„å…‰èŠ’ï¼Œä¸Šé¢åˆ»è‘—ã€Œå”¯æœ‰æ­£ç¢ºçš„åºåˆ—èƒ½é–‹å•Ÿä¸‹ä¸€æ®µæ—…ç¨‹ã€ã€‚ä½ æ„Ÿè¦ºåˆ°å¯¶ç®±åœ¨ç­‰å¾…æŸçµ„æ•¸å­—...</p>
        </div>
        <div class="input-section">
            <p class="hint">æç¤ºï¼šå¯¶ç®±éœ€è¦ä¸€å€‹ç°¡å–®çš„æ•¸å­—åºåˆ—é–‹å•Ÿ</p>
            <input type="password" id="stage4Input" placeholder="è¼¸å…¥å¯†ç¢¼æ‰“é–‹å¯¶ç®±...">
            <button id="stage4Btn">é–‹å•Ÿ</button>
            <p class="error-message" id="stage4Error"></p>
        </div>
        <div class="key-effect" style="display: none;">
            <svg width="50" height="50" viewBox="0 0 50 50">
                <path d="M10 10 L20 20 M20 10 L10 20" stroke="#fbdc05" stroke-width="2"/>
            </svg>
        </div>
        <div class="hint-card" id="hint4">
            <p>æç¤ºç´™ä¸Šè‹¥éš±è‹¥ç¾çš„æ•¸å­—ã€Œ1234ã€ä¼¼ä¹æ˜¯æœ€åŸºæœ¬çš„é †åºæ•¸å­—ï¼Œå¯èƒ½æ˜¯æ‰“é–‹å¯¶ç®±çš„å¯†ç¢¼ã€‚</p>
        </div>
        <button class="hint-btn" id="showHint4">éœ€è¦æç¤ºï¼Ÿ</button>
    </div>
    
    <!-- ç¬¬äº”é—œï¼šå®¶èˆˆ -->
    <div class="stage" id="stage5">
        <h2 class="stage-title">ç¬¬äº”é—œï¼šé£Ÿç‰©ç´€å¿µ</h2>
        <div class="story-section">
            <p>å¯¶ç®±ä¸­çš„ç·šç´¢å¼•å°ä½ ä¾†åˆ°å®¶èˆˆï¼Œé€™è£¡æœ‰å„ç¨®é£Ÿç‰©çš„åœ–åƒå’Œè¨˜æ†¶ã€‚ä½ éœ€è¦æ‰¾å‡ºé€™äº›é£Ÿç‰©ä»£è¡¨çš„å…±åŒå ´æ‰€ã€‚</p>
            <p>ã€Œæœ€å¾Œç™¼ç¾åŸä¾†DéŒ¢å””ä¿‚å’ç”¨ï¼Œä¿‚ç”¨é»è²·ä¸€Dé£Ÿå¾—æ—¢é‡ï¼Œä½†ç™¼ç¾ã€Œå®¶ã€åªå‰©æœ€å¾Œä¸€æ­¥ã€</p>
            <p>ä½ é–‹å§‹ç†è§£ï¼Œé€™äº›éŒ¢å’Œé£Ÿç‰©åœ–åƒå¯èƒ½èˆ‡æŸå€‹é‡è¦çš„åœ°æ–¹æœ‰é—œï¼Œè€Œé‚£å€‹åœ°æ–¹å¾ˆå¯èƒ½æ˜¯æ‰¾å›ã€Œå®¶ã€çš„é—œéµã€‚</p>
        </div>
        <div class="dialogue-container show" id="stage5-dialogue">
            <p class="dialogue-text"><span class="dialogue-name">è€å©†å©†:</span>æˆ‘å€‘æ¯å¤©éƒ½æœƒå»é‚£å€‹åœ°æ–¹è²·æ–°é®®çš„é£Ÿæï¼Œé‚£å…’å……æ»¿äº†äººæƒ…å‘³å’Œç¤¾å€çš„é€£çµã€‚</p>
        </div>
        <div class="location-guide">
            <h3 class="location-title"><span class="location-icon">ğŸ“</span>ç•¶å‰ä½ç½®</h3>
            <div class="location-path">
                <div class="location-step">å–„åŒ¯</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">äº¤é€šè·¯ç·š</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">é¤å»³</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">ç¤¾å€ä¸­å¿ƒ</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">å…¬åœ’</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step active">å®¶èˆˆ</div>
            </div>
            <p class="location-clue">é€™äº›é£Ÿç‰©å›æ†¶çš„å…±åŒä¾†æºæ˜¯ä»€éº¼åœ°æ–¹ï¼Ÿé‚£è£¡å¯èƒ½æ˜¯ä½ çš„ä¸‹ä¸€å€‹ç›®çš„åœ°ã€‚</p>
        </div>
        <div class="story-section objective">
            <p><strong>ç›®æ¨™ï¼š</strong>å°‹æ‰¾é€™äº›é£Ÿç‰©è¨˜æ†¶æ‰€ä»£è¡¨çš„å…±åŒå ´æ‰€ã€‚</p>
        </div>
        <div class="inventory" id="foodInventory">
            <div class="food-item">
                <div class="food-img">ğŸœ</div>
                <p>æ¹¯éºµ</p>
            </div>
            <div class="food-item">
                <div class="food-img">ğŸš</div>
                <p>ç±³é£¯</p>
            </div>
            <div class="food-item">
                <div class="food-img">ğŸ¥Ÿ</div>
                <p>é¤ƒå­</p>
            </div>
            <div class="food-item">
                <div class="food-img">ğŸ²</div>
                <p>ç«é‹</p>
            </div>
            <div class="food-item">
                <div class="food-img">ğŸ¥¬</div>
                <p>è”¬èœ</p>
            </div>
            <div class="food-item">
                <div class="food-img">ğŸª</div>
                <p>é›¶é£Ÿ</p>
            </div>
        </div>
        <div class="story-section note">
            <p>ç•¶ä½ è§¸ç¢°é€™äº›é£Ÿç‰©åœ–åƒæ™‚ï¼Œé–ƒéä¸€äº›æ¨¡ç³Šçš„è¨˜æ†¶ç‰‡æ®µï¼šäººå€‘è²·è³£ã€äº¤è«‡ã€è¨åƒ¹é‚„åƒ¹çš„å ´æ™¯ï¼Œé€™äº›éƒ½ç™¼ç”Ÿåœ¨ä¸€å€‹ç†±é¬§çš„åœ°æ–¹...</p>
        </div>
        <div class="input-section">
            <p class="hint">æç¤ºï¼šé€™äº›é£Ÿç‰©å…±åŒä»£è¡¨è‘—ç¤¾å€ä¸­çš„å“ªå€‹åœ°æ–¹ï¼Ÿ</p>
            <input type="text" id="stage5Input" placeholder="è¼¸å…¥é€™äº›é£Ÿç‰©çš„å…±åŒæºé ­...">
            <button id="stage5Btn">ç¢ºèª</button>
            <p class="error-message" id="stage5Error"></p>
        </div>
        <div class="key-effect" style="display: none;">
            <svg width="50" height="50" viewBox="0 0 50 50">
                <path d="M10 10 L20 20 M20 10 L10 20" stroke="#fbdc05" stroke-width="2"/>
            </svg>
        </div>
        <div class="hint-card" id="hint5">
            <p>é€™äº›éƒ½æ˜¯æ–°é®®çš„é£Ÿæå’Œæ–™ç†ï¼Œåœ¨ç¤¾å€ä¸­å“ªè£¡èƒ½æ‰¾åˆ°æœ€æ–°é®®çš„é£Ÿæï¼Ÿã€Œè¡—å¸‚ã€æ˜¯è³¼è²·é£Ÿç‰©çš„åœ°æ–¹ï¼Œå……æ»¿äººæƒ…å‘³å’Œç¤¾å€é€£çµã€‚</p>
        </div>
        <button class="hint-btn" id="showHint5">éœ€è¦æç¤ºï¼Ÿ</button>
    </div>
    
    <!-- ç¬¬å…­é—œï¼šè¡—å¸‚ -->
    <div class="stage" id="stage6">
        <h2 class="stage-title">ç¬¬å…­é—œï¼šå›å®¶è·¯å¾‘</h2>
        <div class="story-section">
            <p>ä½ ä¾†åˆ°è¡—å¸‚ï¼Œé€™è£¡ç†±é¬§éå‡¡ï¼Œå……æ»¿äº†é£Ÿç‰©å’Œäººæƒ…å‘³ã€‚åœ¨é€™è£¡ï¼Œæ‰€æœ‰çš„ç·šç´¢å’Œè¨˜æ†¶éƒ½äº¤åŒ¯åœ¨ä¸€èµ·ï¼ŒæŒ‡å‘æœ€çµ‚çš„ç›®çš„åœ°ã€‚</p>
            <p>ã€Œå®¶èˆ‡å›æ†¶ï¼Œé‚Šå€‹åœ°æœ‰ä¼¼å®¶çš„æ„Ÿè¦ºï¼Œåˆæœ‰å‘¢Dé£Ÿç‰©å›æ†¶ï¼Œå°±ä¿‚å–„åŒ¯ï¼Œç„¶å¾Œå›å–„åŒ¯ã€</p>
            <p>åœ¨è¡—å¸‚ä¸­æ¼«æ­¥ï¼Œä½ æ„Ÿå—åˆ°é€™è£¡èˆ‡æ‰€æœ‰åœ°æ–¹çš„é€£çµï¼Œä½†åŒæ™‚ä¹Ÿæ˜ç™½é€™åªæ˜¯æ—…ç¨‹çš„ä¸€éƒ¨åˆ†ï¼ŒçœŸæ­£çš„ã€Œå®¶ã€é‚„åœ¨åˆ¥è™•ã€‚</p>
        </div>
        <div class="dialogue-container show" id="stage6-dialogue">
            <p class="dialogue-text"><span class="dialogue-name">å•†è²©:</span>å–„åŒ¯...é‚£å€‹åœ°æ–¹æ˜¯ç¤¾å€çš„å¿ƒï¼Œé€£çµè‘—æˆ‘å€‘æ‰€æœ‰äººã€‚æ‰¾åˆ°é‚£å€‹åœ°æ–¹ï¼Œä½ å°±èƒ½å›å®¶äº†ã€‚</p>
        </div>
        <div class="location-guide">
            <h3 class="location-title"><span class="location-icon">ğŸ“</span>ç•¶å‰ä½ç½®</h3>
            <div class="location-path">
                <div class="location-step">å–„åŒ¯</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">äº¤é€šè·¯ç·š</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">é¤å»³</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">ç¤¾å€ä¸­å¿ƒ</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">å…¬åœ’</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">å®¶èˆˆ</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step active">è¡—å¸‚</div>
            </div>
            <p class="location-clue">æ‰€æœ‰çš„å›æ†¶å’Œæƒ…æ„Ÿéƒ½æŒ‡å‘ä¸€å€‹åœ°æ–¹ï¼Œé‚£è£¡æ—¢æ˜¯ä½ æ—…ç¨‹çš„èµ·é»ï¼Œä¹Ÿæ˜¯çµ‚é»ã€‚</p>
        </div>
        <div class="story-section objective">
            <p><strong>ç›®æ¨™ï¼š</strong>æ‰¾å‡ºæ‰€æœ‰è¨˜æ†¶çš„æ ¸å¿ƒï¼ŒçœŸæ­£çš„ã€Œå®¶ã€åœ¨å“ªè£¡ã€‚</p>
        </div>
        <div class="map-container" id="finalMap">
            <div class="location" style="top: 20%; left: 20%">
                <span class="location-label">å®¶èˆˆä¸­å¿ƒ</span>
            </div>
            <div class="location" style="top: 40%; left: 50%">
                <span class="location-label">ç¤¾å€ä¸­å¿ƒ</span>
            </div>
            <div class="location" style="top: 60%; left: 70%">
                <span class="location-label">å…¬åœ’</span>
            </div>
            <div class="location" style="top: 70%; left: 30%">
                <span class="location-label">é¤å»³</span>
            </div>
            <div class="location" style="top: 40%; left: 80%">
                <span class="location-label">äº¤é€šè·¯ç·š</span>
            </div>
            <div class="location pulse" style="top: 30%; left: 50%">
                <span class="location-label">å–„åŒ¯</span>
            </div>
        </div>
        <div class="story-section note">
            <p>ç•¶ä½ åœ¨è¡—å¸‚ä¸­æµé€£ï¼Œç™¼ç¾æ‰€æœ‰çš„å•†è²©ã€é¡§å®¢éƒ½åœ¨è«‡è«–è‘—åŒä¸€å€‹åœ°æ–¹ï¼Œé‚£æ˜¯ç¤¾å€çš„å¿ƒè‡Ÿï¼Œæ‰€æœ‰äººæƒ…å‘³å’Œé€£çµçš„æºé ­ï¼Œå®ƒçš„åå­—æ˜¯...</p>
        </div>
        <div class="input-section">
            <p class="hint">æç¤ºï¼šæ‰€æœ‰è¨˜æ†¶çš„æºé ­ï¼Œé€™å€‹æ—…ç¨‹çš„èµ·é»å’Œçµ‚é»</p>
            <input type="text" id="stage6Input" placeholder="è¼¸å…¥ã€Œå®¶ã€çš„åç¨±...">
            <button id="stage6Btn">ç¢ºèª</button>
            <p class="error-message" id="stage6Error"></p>
        </div>
        <div class="key-effect" style="display: none;">
            <svg width="50" height="50" viewBox="0 0 50 50">
                <path d="M10 10 L20 20 M20 10 L10 20" stroke="#fbdc05" stroke-width="2"/>
            </svg>
        </div>
        <div class="hint-card" id="hint6">
            <p>å›é¡§ä½ çš„æ•´å€‹æ—…ç¨‹ï¼Œå¾å“ªè£¡é–‹å§‹ï¼Œåˆå°‡å›åˆ°å“ªè£¡ï¼Ÿåœ°åœ–ä¸Šå”¯ä¸€ç™¼å…‰çš„åœ°é»æç¤ºè‘—ç­”æ¡ˆã€‚ã€Œå–„åŒ¯ã€ä¸åƒ…æ˜¯åœ°åï¼Œä¹Ÿè±¡å¾µè‘—æ‰€æœ‰ç¾å¥½å›æ†¶å’Œæƒ…æ„Ÿçš„åŒ¯èšä¹‹è™•ã€‚</p>
        </div>
        <button class="hint-btn" id="showHint6">éœ€è¦æç¤ºï¼Ÿ</button>
    </div>
    
    <!-- çµå±€ -->
    <div class="stage" id="ending">
        <h2 class="stage-title">å¿ƒä¹‹å›æ­¸ï¼šå°‹å›ã€Œå®¶ã€çš„æ„Ÿè¦º</h2>
        <div class="story-section">
            <p>ç•¶ä½ èªªå‡ºã€Œå–„åŒ¯ã€çš„åå­—ï¼Œæ‰€æœ‰è¨˜æ†¶ç¬é–“èåˆï¼Œå¼·çƒˆçš„å…‰èŠ’é–ƒè€€ã€‚ä½ çµ‚æ–¼æ‰¾åˆ°äº†å¿ƒä¹‹é–åŒ™ï¼Œä¹Ÿæ‰¾åˆ°äº†çœŸæ­£çš„ã€Œå®¶ã€ã€‚</p>
            <p>ã€Œæ­å–œä½ æ‰¾åˆ°äº†å¿ƒä¹‹é–åŒ™ã€‚ç¾åœ¨ä½ æ˜ç™½äº†ï¼Œå–„åŒ¯ä¸åƒ…æ˜¯ä¸€å€‹åœ°æ–¹ï¼Œæ›´æ˜¯ä¸€ç¨®é€£çµã€ä¸€ç¨®æƒ…æ„Ÿã€ä¸€ç¨®æ­¸å±¬æ„Ÿã€‚ã€</p>
            <p>ã€Œä½ ä¸æ˜¯å­¤å–®çš„æ—…è¡Œè€…ï¼Œå¯¦éš›ä¸Šï¼Œä½ ä¸€ç›´éƒ½æ˜¯å–„åŒ¯çš„ä¸€éƒ¨åˆ†ï¼Œè€Œå–„åŒ¯çš„è¨˜æ†¶ä¹Ÿæ˜¯ä½ çš„ä¸€éƒ¨åˆ†ã€‚ã€</p>
        </div>
        <div class="dialogue-container show" id="ending-dialogue">
            <p class="dialogue-text"><span class="dialogue-name">è€å©†å©†:</span>æˆ‘å€‘ä¸€ç›´åœ¨ç­‰ä½ ã€‚è¬è¬ä½ å¹«åŠ©æˆ‘å€‘æ‰¾å›éºå¤±çš„å¿ƒã€‚å–„åŒ¯ä¸åªæ˜¯ä¸€å€‹åœ°æ–¹ï¼Œè€Œæ˜¯æˆ‘å€‘å…±åŒå‰µé€ çš„å¿ƒéˆå®¶åœ’ã€‚</p>
        </div>
        <div class="void-heart filling" id="endingHeart"></div>
        <div class="location-guide">
            <h3 class="location-title"><span class="location-icon">ğŸ </span>å›åˆ°èµ·é»</h3>
            <div class="location-path">
                <div class="location-step">å–„åŒ¯</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">äº¤é€šè·¯ç·š</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">é¤å»³</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">ç¤¾å€ä¸­å¿ƒ</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">å…¬åœ’</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">å®¶èˆˆ</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step">è¡—å¸‚</div>
                <span class="location-arrow">â†’</span>
                <div class="location-step active">å–„åŒ¯</div>
            </div>
            <p class="location-clue">æ—…ç¨‹çµæŸäº†ï¼Œä½†ã€Œå®¶ã€çš„æ•…äº‹æ‰å‰›å‰›é–‹å§‹ã€‚</p>
        </div>
        <div class="story-section">
            <p>å…‰èŠ’æ¼¸æ¼¸æ¶ˆæ•£ï¼Œè¿·éœ§æ•£å»ã€‚ä½ ç™¼ç¾è‡ªå·±ç«™åœ¨ç†Ÿæ‚‰çš„å–„åŒ¯ç¤¾å€ä¸­å¿ƒï¼Œå‘¨åœæ˜¯ç†Ÿæ‚‰çš„é¢å­”ï¼Œä½†é€™æ¬¡ï¼Œæ¯å€‹äººçš„çœ¼ä¸­éƒ½å……æ»¿äº†ç”Ÿå‘½åŠ›å’Œæƒ…æ„Ÿã€‚</p>
            <p>ä½ ç’°é¡§å››å‘¨ï¼Œç†è§£äº†ä¸€åˆ‡ã€‚é€™ä¸æ˜¯ä¸€å€‹è¿·é€”çš„ç•°ç©ºé–“ï¼Œè€Œæ˜¯ä½ å€‘å…±åŒå‰µé€ çš„å®¶åœ’ã€‚è€Œã€Œå¿ƒä¹‹é–åŒ™ã€ï¼Œæ­£æ˜¯å½¼æ­¤é–“çš„é€£çµå’Œé—œæ‡·ã€‚</p>
        </div>
        <div class="achievements">
            <div class="achievement unlocked" id="achievement1End">
                ğŸ”
                <span class="achievement-label">è¿·å¢ƒæ¢ç´¢è€…</span>
            </div>
            <div class="achievement unlocked" id="achievement2End">
                ğŸ’¬
                <span class="achievement-label">è™›å¯¦é€£çµè€…</span>
            </div>
            <div class="achievement unlocked" id="achievement3End">
                ğŸ§©
                <span class="achievement-label">è¬é¡Œè§£é–è€…</span>
            </div>
            <div class="achievement unlocked" id="achievement4End">
                ğŸ¤
                <span class="achievement-label">å¿ƒéˆä¿®å¾©å¸«</span>
            </div>
            <div class="achievement unlocked" id="achievement5End">
                ğŸ†
                <span class="achievement-label">å–„åŒ¯å®ˆè­·è€…</span>
            </div>
        </div>
        <div class="effect-container" id="endingEffect"></div>
        <div class="notebook" id="notebook-ending">
            <div class="notebook-inner">
                <div class="notebook-front">
                    <div class="envelope-icon">âœ‰ï¸</div>
                </div>
                <div class="notebook-back">
                    <h3 class="notebook-title">è¿·é€”ç­†è¨˜ - çµ‚ç« </h3>
                    <p class="notebook-entry">æ—…ç¨‹çµæŸäº†ï¼Œä½†æˆ‘æ„Ÿåˆ°å‰æ‰€æœªæœ‰çš„å®Œæ•´ã€‚æ‰¾å›å¿ƒä¹‹é–åŒ™ä¸¦ä¸æ˜¯æ‰¾åˆ°æŸå€‹ç‰©å“ï¼Œè€Œæ˜¯é‡æ–°é€£æ¥èˆ‡ç¤¾å€ã€èˆ‡ä»–äººçš„æƒ…æ„Ÿç´å¸¶ã€‚</p>
                    <p class="notebook-entry"><span class="notebook-highlight">å–„åŒ¯</span>ä¸åªæ˜¯ä¸€å€‹åœ°æ–¹ï¼Œè€Œæ˜¯æ‰€æœ‰äººå…±åŒå‰µé€ çš„<span class="notebook-highlight">å¿ƒéˆå®¶åœ’</span>ã€‚æ­£å¦‚å®ƒçš„åå­—æ‰€æš—ç¤ºï¼šå–„è‰¯åŒ¯èšä¹‹è™•ï¼Œå°±æ˜¯æˆ‘çœŸæ­£çš„å®¶ã€‚</p>
                </div>
            </div>
        </div>
        <div class="input-section">
            <button id="restartBtn">é‡æ–°é–‹å§‹æ—…ç¨‹</button>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        let currentStage = 0;
        const totalStages = 6;
        const stages = ['intro', 'stage1', 'stage2', 'stage3', 'stage4', 'stage5', 'stage6', 'ending'];
        
        const answers = {
            stage1: '999',
            stage2: 'æ˜Œ',
            stage3: 'å…¬åœ’',
            stage4: '1234',
            stage5: 'è¡—å¸‚',
            stage6: 'å–„åŒ¯'
        };
        
        const alternativeAnswers = {
            stage2: ['ä½ æ˜¯èª°', 'ä½ ä¿‚é‚Šå€‹', 'ä½ å«å’©å', 'ä½ ä¿‚å’©äºº', 'èº«ä»½', 'ä½ æ˜¯èª°ï¼Ÿ', 'æ˜Œ'],
            stage3: ['å¿ƒéˆä¼‘æ†©è™•', 'ä¼‘æ†©è™•', 'å¿ƒéˆä¼‘æ¯è™•', 'å…¬åœ’'],
            stage5: ['è¡—å¸‚', 'å¸‚å ´', 'å‚³çµ±å¸‚å ´', 'èœå¸‚å ´'],
            stage6: ['å–„åŒ¯', 'å–„åŒ¯ç¤¾å€', 'å–„åŒ¯ä¸­å¿ƒ']
        };
        
        const cutscenes = {
            intro: { title: "å¿ƒä¹‹è¿·é€”", text: "ä½ é†’ä¾†æ–¼ä¸€å€‹ç†Ÿæ‚‰åˆé™Œç”Ÿçš„ç©ºé–“ï¼Œé€™è£¡åƒæ˜¯ç¤¾å€çš„å€’å½±ï¼Œå»ç± ç½©è‘—è©­ç•°çš„æ°›åœã€‚æ›´å¥‡æ€ªçš„æ˜¯ï¼Œä½ æ„Ÿè¦ºä¸åˆ°ä»»ä½•æƒ…æ„Ÿï¼Œå¦‚åŒå¿ƒæ˜¯ç©ºæ´çš„ã€‚" },
            stage1: { title: "äº¤é€šå¯†ç¢¼", text: "ä½ ä¾†åˆ°ç¤¾å€çš„äº¤é€šè·¯ç·šï¼Œå‘¨åœé£„æ•£è‘—æ¨¡ç³Šçš„æ•¸å­—ç¢ç‰‡ã€‚é€™äº›æ•¸å­—ä¼¼ä¹è©¦åœ–è¨´èªªè‘—ä»€éº¼ï¼Œå®ƒå€‘èšé›†åœ¨å·´å£«ç«™é™„è¿‘ï¼Œç­‰å¾…è‘—è¢«è§£è®€ã€‚" },
            stage2: { title: "ç¥ç§˜é€šè¨Š", text: "é¤å»³è£¡çš„é™Œç”Ÿäººéçµ¦ä½ ä¸€éƒ¨æ‰‹æ©Ÿï¼Œä¸Šé¢å·²æœ‰ä¸€çµ„è™Ÿç¢¼ã€‚é€™çµ„è™Ÿç¢¼æˆ–è¨±èƒ½é€£çµåˆ°é‡è¦çš„äººï¼Œå¹«åŠ©ä½ ç†è§£é€™å€‹ç©ºé–“çš„è¬é¡Œã€‚" },
            stage3: { title: "ç¤¾å€æ´»å‹•", text: "ç¤¾å€ä¸­å¿ƒå……æ»¿äº†æ´»å‹•å’Œå›æ†¶çš„ç—•è·¡ï¼Œé€™è£¡çš„æ¯å€‹ç©ºé–“éƒ½è˜Šå«è‘—å±…æ°‘çš„æƒ…æ„Ÿèˆ‡é€£çµã€‚å…¶ä¸­ä¸€å€‹ç‰¹åˆ¥çš„åœ°æ–¹æˆ–è¨±èƒ½å¼•å°ä½ å‰å¾€ä¸‹ä¸€å€‹ç›®çš„åœ°ã€‚" },
            stage4: { title: "ç¥ç§˜å¯¶ç®±", text: "å…¬åœ’çš„è‰å¢ä¸­è—è‘—ä¸€å€‹å¥‡ç‰¹çš„å¯¶ç®±ï¼Œé–ƒçˆè‘—å¾®å¼±çš„å…‰èŠ’ã€‚å®ƒä¼¼ä¹åœ¨ç­‰å¾…æŸçµ„å¯†ç¢¼ï¼Œæ‰“é–‹å®ƒå¯èƒ½æœƒæ­ç¤ºæ›´å¤šé—œæ–¼é€™å€‹ä¸–ç•Œçš„ç§˜å¯†ã€‚" },
            stage5: { title: "é£Ÿç‰©ç´€å¿µ", text: "å„ç¨®é£Ÿç‰©çš„è¨˜æ†¶åœ¨å®¶èˆˆäº¤ç¹”ï¼Œæ¯ä¸€ç¨®é£Ÿç‰©éƒ½é€£çµè‘—ç¤¾å€çš„æŸå€‹è§’è½ã€‚é€™äº›é£Ÿç‰©ä¾†è‡ªå“ªè£¡ï¼Ÿé‚£å€‹åœ°æ–¹æˆ–è¨±æ˜¯ä½ å°‹æ‰¾ã€Œå®¶ã€çš„é—œéµã€‚" },
            stage6: { title: "å›å®¶è·¯å¾‘", text: "åœ¨ç†±é¬§çš„è¡—å¸‚ä¸­ï¼Œæ‰€æœ‰çš„ç·šç´¢èˆ‡è¨˜æ†¶åŒ¯èšä¸€è™•ã€‚ä½ çš„æ—…ç¨‹å·²è¿‘çµ‚é»ï¼ŒçœŸæ­£çš„ã€Œå®¶ã€å°±åœ¨çœ¼å‰ï¼Œå°±æ˜¯æ‰€æœ‰å›æ†¶çš„èµ·é»ã€‚" },
            ending: { title: "å¿ƒä¹‹å›æ­¸", text: "ç•¶ä½ èªªå‡ºã€Œå–„åŒ¯ã€çš„åå­—ï¼Œæ‰€æœ‰è¨˜æ†¶ç¬é–“èåˆï¼Œå¼·çƒˆçš„å…‰èŠ’é–ƒè€€ã€‚ä½ çµ‚æ–¼æ‰¾åˆ°äº†å¿ƒä¹‹é–åŒ™ï¼Œä¹Ÿæ‰¾åˆ°äº†çœŸæ­£çš„ã€Œå®¶ã€ã€‚" }
        };
        
        const envelopeContent = {
            intro: { title: "å¿ƒä¹‹è¿·é€”", content: "ä½ é†’ä¾†æ–¼ä¸€å€‹ç†Ÿæ‚‰åˆé™Œç”Ÿçš„ç©ºé–“ï¼Œå¦‚åŒç¤¾å€çš„å€’å½±ï¼Œå»ç± ç½©è‘—è©­ç•°çš„æ°›åœã€‚ä½ æ„Ÿè¦ºä¸åˆ°ä»»ä½•æƒ…æ„Ÿï¼Œå¿ƒæ˜¯ç©ºæ´çš„ã€‚æ‰¾å›å¿ƒä¹‹é–åŒ™ï¼Œæ‰èƒ½æ¢å¾©è‡ªæˆ‘ã€‚" },
            stage1: { title: "äº¤é€šå¯†ç¢¼", content: "æ•¸å­—åœ¨ç©ºæ°£ä¸­é£„æµ®ï¼Œè©¦åœ–å¼•å°ä½ æ‰¾åˆ°é—œéµã€‚æ³¨æ„å·´å£«ç«™é™„è¿‘çš„ç‰¹æ®Šæ•¸å­—ï¼Œå®ƒå€‘å°‡é€£æ¥ä½ èˆ‡ä¸‹ä¸€å€‹ç›®çš„åœ°ã€‚" },
            stage2: { title: "ç¥ç§˜é€šè¨Š", content: "é€™éƒ¨æ‰‹æ©Ÿé€£æ¥è‘—ä¸€å€‹é‡è¦çš„äººç‰©ï¼Œä»–èƒ½ç‚ºä½ è§£ç­”æ›´å¤šè¬åœ˜ã€‚æ’¥é€šè™Ÿç¢¼ï¼Œè©¢å•ä»–çš„èº«ä»½ï¼Œå°‹æ‰¾å‰å¾€ç¤¾å€ä¸­å¿ƒçš„é“è·¯ã€‚" },
            stage3: { title: "ç¤¾å€æ´»å‹•", content: "ç¤¾å€ä¸­å¿ƒæœ‰å€‹ç‰¹åˆ¥çš„å ´æ‰€ï¼Œé‚£è£¡æ‰¿è¼‰è‘—å±…æ°‘çš„å¿ƒéˆä¼‘æ†©ã€‚æ‰¾åˆ°é‚£å€‹åœ°æ–¹ï¼Œä½ å°‡æ›´æ¥è¿‘å¿ƒä¹‹é–åŒ™ã€‚" },
            stage4: { title: "ç¥ç§˜å¯¶ç®±", content: "å…¬åœ’ä¸­çš„å¯¶ç®±è˜Šè—è‘—ä¸‹ä¸€æ­¥çš„æç¤ºã€‚æ­£ç¢ºçš„æ•¸å­—åºåˆ—å°‡é–‹å•Ÿå®ƒï¼Œæ­ç¤ºè³¼è²·é£Ÿç‰©çš„æ„ç¾©ã€‚" },
            stage5: { title: "é£Ÿç‰©ç´€å¿µ", content: "é€™äº›é£Ÿç‰©ä¾†è‡ªåŒä¸€å€‹åœ°æ–¹ï¼Œé‚£è£¡å……æ»¿äººæƒ…å‘³å’Œç¤¾å€çš„é€£çµã€‚æ‰¾å‡ºé€™å€‹åœ°æ–¹ï¼Œä½ å°‡æ›´æ¥è¿‘ã€Œå®¶ã€çš„çœŸæ­£å«ç¾©ã€‚" },
            stage6: { title: "å›å®¶è·¯å¾‘", content: "æ‰€æœ‰ç·šç´¢æŒ‡å‘ä¸€å€‹åœ°æ–¹ï¼Œå®ƒæ—¢æ˜¯ä½ æ—…ç¨‹çš„èµ·é»ï¼Œä¹Ÿæ˜¯çµ‚é»ã€‚é€™å€‹åœ°æ–¹çš„åå­—ï¼Œä»£è¡¨è‘—ç¤¾å€å¿ƒéˆçš„èšé›†åœ°ã€‚" },
            ending: { title: "å¿ƒä¹‹å›æ­¸", content: "æ­å–œä½ æ‰¾åˆ°äº†å¿ƒä¹‹é–åŒ™ï¼å–„åŒ¯ä¸åƒ…æ˜¯ä¸€å€‹åœ°æ–¹ï¼Œæ›´æ˜¯ä¸€ç¨®é€£çµã€ä¸€ç¨®æƒ…æ„Ÿã€ä¸€ç¨®æ­¸å±¬æ„Ÿã€‚ä½ å·²é‡æ–°é€£æ¥èˆ‡ç¤¾å€ã€èˆ‡ä»–äººçš„æƒ…æ„Ÿç´å¸¶ã€‚" }
        };
        
        const notebooks = document.querySelectorAll('.notebook');
        notebooks.forEach(notebook => {
            notebook.addEventListener('click', function() {
                this.classList.toggle('flipped');
            });
        });
        
        function updateProgress() {
            const progressBar = document.getElementById('progressBar');
            const progressPercentage = (currentStage / totalStages) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            for (let i = 0; i <= totalStages; i++) {
                const node = document.getElementById(`node${i}`);
                if (node) {
                    if (i < currentStage) {
                        node.classList.remove('current', 'locked');
                        node.classList.add('completed');
                    } else if (i === currentStage) {
                        node.classList.remove('completed', 'locked');
                        node.classList.add('current');
                    } else {
                        node.classList.remove('completed', 'current');
                        node.classList.add('locked');
                    }
                }
            }
        }
        
        function showEnvelope(stage) {
            const envelope = document.getElementById('envelope-container');
            const letterTitle = document.getElementById('letter-title');
            const letterContent = document.getElementById('letter-content');
            letterTitle.textContent = envelopeContent[stages[stage]].title;
            letterContent.textContent = envelopeContent[stages[stage]].content;
            envelope.classList.add('active');
            setTimeout(() => {
                envelope.classList.add('opening');
                setTimeout(() => {
                    envelope.classList.remove('opening');
                    setTimeout(() => {
                        envelope.classList.remove('active');
                        setTimeout(() => {
                            showCutscene(stage);
                        }, 500);
                    }, 2000);
                }, 5000);
            }, 1000);
            envelope.addEventListener('click', function closeHandler() {
                envelope.classList.remove('opening');
                setTimeout(() => {
                    envelope.classList.remove('active');
                }, 500);
                envelope.removeEventListener('click', closeHandler);
                setTimeout(() => {
                    showCutscene(stage);
                }, 500);
            });
        }
        
        function showCutscene(stage) {
            const cutscene = document.getElementById('cutscene');
            const cutsceneTitle = document.getElementById('cutscene-title');
            const cutsceneText = document.getElementById('cutscene-text');
            cutsceneTitle.textContent = cutscenes[stages[stage]].title;
            cutsceneText.textContent = cutscenes[stages[stage]].text;
            cutscene.classList.add('active');
            cutscene.addEventListener('click', function closeHandler() {
                cutscene.classList.remove('active');
                cutscene.removeEventListener('click', closeHandler);
            });
            setTimeout(() => {
                cutscene.classList.remove('active');
            }, 6000);
        }
        
        function switchStage(fromStage, toStage) {
            document.getElementById(stages[fromStage]).classList.remove('active');
            document.getElementById(stages[toStage]).classList.add('active');
            currentStage = toStage;
            updateProgress();
            notebooks.forEach(notebook => {
                notebook.classList.remove('flipped');
            });
            document.getElementById(stages[toStage]).style.animation = 'none';
            setTimeout(() => {
                document.getElementById(stages[toStage]).style.animation = 'fadeIn 1s ease';
            }, 10);
            showEnvelope(toStage);
            if (toStage === 2) initPhoneChat();
            else if (toStage === 4) initTreasureBox();
            else if (toStage === 7) createEndingEffect();
            createSceneTransitionEffect();
        }
        
        function createSceneTransitionEffect() {
            const gameContainer = document.querySelector('.game-container');
            const effectContainer = document.createElement('div');
            effectContainer.className = 'effect-container';
            gameContainer.appendChild(effectContainer);
            for (let i = 0; i < 30; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = `${Math.random() * 100}%`;
                sparkle.style.top = `${Math.random() * 100}%`;
                sparkle.style.opacity = '0';
                effectContainer.appendChild(sparkle);
                setTimeout(() => {
                    sparkle.style.transition = 'all 0.8s ease';
                    sparkle.style.opacity = '1';
                    setTimeout(() => {
                        sparkle.style.opacity = '0';
                    }, 600);
                }, Math.random() * 300);
            }
            setTimeout(() => {
                effectContainer.remove();
            }, 1500);
        }
        
        function createEffect(element, type) {
            const effectContainer = document.createElement('div');
            effectContainer.className = 'effect-container';
            element.appendChild(effectContainer);
            if (type === 'confetti') {
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = `${Math.random() * 100}%`;
                    confetti.style.top = `${Math.random() * 100}%`;
                    confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
                    confetti.style.width = `${5 + Math.random() * 10}px`;
                    confetti.style.height = `${5 + Math.random() * 10}px`;
                    confetti.style.opacity = '1';
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                    effectContainer.appendChild(confetti);
                    setTimeout(() => {
                        confetti.style.transition = 'all 2s ease';
                        confetti.style.top = '100%';
                        confetti.style.opacity = '0';
                    }, Math.random() * 500);
                }
                setTimeout(() => {
                    effectContainer.remove();
                }, 3000);
            } else if (type === 'sparkle') {
                for (let i = 0; i < 30; i++) {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'sparkle';
                    sparkle.style.left = `${Math.random() * 100}%`;
                    sparkle.style.top = `${Math.random() * 100}%`;
                    sparkle.style.opacity = '1';
                    effectContainer.appendChild(sparkle);
                    setTimeout(() => {
                        sparkle.style.transition = 'all 1s ease';
                        sparkle.style.transform = `translate(${(Math.random() - 0.5) * 100}px, ${(Math.random() - 0.5) * 100}px)`;
                        sparkle.style.opacity = '0';
                    }, Math.random() * 300);
                }
                setTimeout(() => {
                    effectContainer.remove();
                }, 2000);
            }
        }
        
        function initPhoneChat() {
            const phoneScreen = document.getElementById('phoneScreen');
            phoneScreen.innerHTML = '';
            const initialMessage = document.createElement('div');
            initialMessage.className = 'message incoming';
            initialMessage.textContent = 'ä½ å¥½ï¼Œé€™è£¡æ˜¯æ˜Œã€‚æˆ‘ä¸å¤ªæ˜ç™½ä½ åœ¨èªªä»€éº¼...ä½ éœ€è¦ä»€éº¼å¹«åŠ©å—ï¼Ÿ';
            phoneScreen.appendChild(initialMessage);
        }
        
        function initTreasureBox() {
            const treasureBox = document.getElementById('treasureBox');
            treasureBox.classList.remove('open');
            treasureBox.addEventListener('click', function() {
                const input = document.getElementById('stage4Input').value;
                if (input === answers.stage4) {
                    treasureBox.classList.add('open');
                    createEffect(treasureBox, 'sparkle');
                    setTimeout(() => {
                        document.getElementById('stage4Btn').click();
                    }, 2000);
                } else {
                    treasureBox.classList.add('shake');
                    setTimeout(() => {
                        treasureBox.classList.remove('shake');
                    }, 500);
                    document.getElementById('stage4Error').textContent = 'å¯†ç¢¼éŒ¯èª¤ï¼Œå¯¶ç®±æ‹’çµ•æ‰“é–‹';
                }
            });
        }
        
        function createEndingEffect() {
            const endingEffect = document.getElementById('endingEffect');
            createEffect(endingEffect.parentElement, 'confetti');
            const title = document.querySelector('#ending .stage-title');
            title.classList.add('glow');
            setTimeout(() => {
                createEffect(endingEffect.parentElement, 'sparkle');
            }, 2000);
            setTimeout(() => {
                createEffect(endingEffect.parentElement, 'confetti');
            }, 4000);
        }
        
        function checkAnswer(stage, input) {
            input = input.trim().toLowerCase();
            if (input === answers[stage].toLowerCase()) return true;
            if (alternativeAnswers[stage]) {
                for (let i = 0; i < alternativeAnswers[stage].length; i++) {
                    if (input === alternativeAnswers[stage][i].toLowerCase() || 
                        input.includes(alternativeAnswers[stage][i].toLowerCase())) {
                        return true;
                    }
                }
            }
            return false;
        }
        
        document.getElementById('showHint1').addEventListener('click', function() {
            document.getElementById('hint1').classList.toggle('show');
            this.textContent = document.getElementById('hint1').classList.contains('show') ? 'éš±è—æç¤º' : 'éœ€è¦æç¤ºï¼Ÿ';
        });
        document.getElementById('showHint2').addEventListener('click', function() {
            document.getElementById('hint2').classList.toggle('show');
            this.textContent = document.getElementById('hint2').classList.contains('show') ? 'éš±è—æç¤º' : 'éœ€è¦æç¤ºï¼Ÿ';
        });
        document.getElementById('showHint3').addEventListener('click', function() {
            document.getElementById('hint3').classList.toggle('show');
            this.textContent = document.getElementById('hint3').classList.contains('show') ? 'éš±è—æç¤º' : 'éœ€è¦æç¤ºï¼Ÿ';
        });
        document.getElementById('showHint4').addEventListener('click', function() {
            document.getElementById('hint4').classList.toggle('show');
            this.textContent = document.getElementById('hint4').classList.contains('show') ? 'éš±è—æç¤º' : 'éœ€è¦æç¤ºï¼Ÿ';
        });
        document.getElementById('showHint5').addEventListener('click', function() {
            document.getElementById('hint5').classList.toggle('show');
            this.textContent = document.getElementById('hint5').classList.contains('show') ? 'éš±è—æç¤º' : 'éœ€è¦æç¤ºï¼Ÿ';
        });
        document.getElementById('showHint6').addEventListener('click', function() {
            document.getElementById('hint6').classList.toggle('show');
            this.textContent = document.getElementById('hint6').classList.contains('show') ? 'éš±è—æç¤º' : 'éœ€è¦æç¤ºï¼Ÿ';
        });
        
        document.getElementById('gameStartBtn').addEventListener('click', function() {
            document.querySelector('.start-screen').style.display = 'none';
            document.querySelector('.game-container').style.display = 'block';
            updateProgress();
            setTimeout(() => {
                showEnvelope(0);
            }, 500);
        });
        
        document.getElementById('startBtn').addEventListener('click', function() {
            switchStage(0, 1);
        });
        
        document.getElementById('stage1Btn').addEventListener('click', function() {
            const input = document.getElementById('stage1Input').value.trim();
            const errorMsg = document.getElementById('stage1Error');
            const keyEffect = document.querySelector('#stage1 .key-effect');
            if (input === answers.stage1) {
                errorMsg.textContent = '';
                createEffect(this.parentElement, 'sparkle');
                keyEffect.style.display = 'block';
                setTimeout(() => {
                    keyEffect.classList.add('show');
                }, 10);
                this.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 300);
                setTimeout(() => {
                    switchStage(1, 2);
                    keyEffect.classList.remove('show');
                    setTimeout(() => {
                        keyEffect.style.display = 'none';
                    }, 500);
                }, 2000);
            } else {
                errorMsg.textContent = 'é€™ä¸æ˜¯æ­£ç¢ºçš„æ•¸å­—åºåˆ—ï¼Œç¹¼çºŒå°‹æ‰¾äº¤é€šè·¯ç·šä¸­çš„å¯†ç¢¼';
                this.classList.add('shake');
                setTimeout(() => {
                    this.classList.remove('shake');
                }, 500);
            }
        });
        
        document.getElementById('stage2Btn').addEventListener('click', function() {
            const input = document.getElementById('stage2Input').value.trim().toLowerCase();
            const errorMsg = document.getElementById('stage2Error');
            const phoneScreen = document.getElementById('phoneScreen');
            const keyEffect = document.querySelector('#stage2 .key-effect');
            const userMessage = document.createElement('div');
            userMessage.className = 'message outgoing';
            userMessage.textContent = document.getElementById('stage2Input').value;
            phoneScreen.appendChild(userMessage);
            phoneScreen.scrollTop = phoneScreen.scrollHeight;
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'message incoming';
            typingIndicator.innerHTML = '<span style="opacity: 0.7">...</span>';
            phoneScreen.appendChild(typingIndicator);
            setTimeout(() => {
                phoneScreen.removeChild(typingIndicator);
                if (checkAnswer('stage2', input)) {
                    errorMsg.textContent = '';
                    const replyMessage = document.createElement('div');
                    replyMessage.className = 'message incoming';
                    replyMessage.textContent = 'æˆ‘æ˜¯å–„åŒ¯çš„ç¤¾å·¥æ˜Œã€‚å¾ˆé«˜èˆˆèƒ½å”åŠ©ä½ ã€‚ä½ ç¾åœ¨æ‡‰è©²å‰å¾€ç¤¾å€ä¸­å¿ƒï¼Œé‚£è£¡æœ‰è¨±å¤šæ´»å‹•å’Œä¼‘æ†©è™•ï¼Œå¯èƒ½æœƒæ‰¾åˆ°æ›´å¤šç·šç´¢ã€‚';
                    phoneScreen.appendChild(replyMessage);
                    phoneScreen.scrollTop = phoneScreen.scrollHeight;
                    keyEffect.style.display = 'block';
                    setTimeout(() => {
                        keyEffect.classList.add('show');
                    }, 10);
                    this.style.transform = 'scale(1.1)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 300);
                    setTimeout(() => {
                        switchStage(2, 3);
                        keyEffect.classList.remove('show');
                        setTimeout(() => {
                            keyEffect.style.display = 'none';
                        }, 500);
                    }, 3000);
                } else {
                    const replyMessage = document.createElement('div');
                    replyMessage.className = 'message incoming';
                    replyMessage.textContent = 'æˆ‘ä¸å¤ªæ˜ç™½ä½ åœ¨èªªä»€éº¼...ä½ éœ€è¦çŸ¥é“æˆ‘æ˜¯èª°å—ï¼Ÿæˆ‘æ˜¯æ˜Œï¼Œå–„åŒ¯çš„ç¤¾å·¥ã€‚';
                    phoneScreen.appendChild(replyMessage);
                    phoneScreen.scrollTop = phoneScreen.scrollHeight;
                    errorMsg.textContent = 'å˜—è©¦ç›´æ¥è©¢å•å°æ–¹çš„èº«ä»½';
                }
            }, 1200);
            document.getElementById('stage2Input').value = '';
        });
        
        document.getElementById('stage3Btn').addEventListener('click', function() {
            const input = document.getElementById('stage3Input').value.trim().toLowerCase();
            const errorMsg = document.getElementById('stage3Error');
            const keyEffect = document.querySelector('#stage3 .key-effect');
            if (checkAnswer('stage3', input)) {
                errorMsg.textContent = '';
                createEffect(this.parentElement, 'sparkle');
                keyEffect.style.display = 'block';
                setTimeout(() => {
                    keyEffect.classList.add('show');
                }, 10);
                this.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 300);
                setTimeout(() => {
                    switchStage(3, 4);
                    keyEffect.classList.remove('show');
                    setTimeout(() => {
                        keyEffect.style.display = 'none';
                    }, 500);
                }, 2000);
            } else {
                errorMsg.textContent = 'é€™å€‹åœ°æ–¹ä¼¼ä¹ä¸æ˜¯ç¤¾å€æ´»å‹•çš„ä¸»è¦å ´æ‰€ï¼Œç¹¼çºŒå°‹æ‰¾';
                this.classList.add('shake');
                setTimeout(() => {
                    this.classList.remove('shake');
                }, 500);
            }
        });
        
        document.getElementById('stage4Btn').addEventListener('click', function() {
            const input = document.getElementById('stage4Input').value;
            const errorMsg = document.getElementById('stage4Error');
            const treasureBox = document.getElementById('treasureBox');
            const keyEffect = document.querySelector('#stage4 .key-effect');
            if (input === answers.stage4) {
                errorMsg.textContent = '';
                if (!treasureBox.classList.contains('open')) {
                    treasureBox.classList.add('open');
                    createEffect(treasureBox, 'sparkle');
                }
                keyEffect.style.display = 'block';
                setTimeout(() => {
                    keyEffect.classList.add('show');
                }, 10);
                this.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 300);
                setTimeout(() => {
                    switchStage(4, 5);
                    keyEffect.classList.remove('show');
                    setTimeout(() => {
                        keyEffect.style.display = 'none';
                    }, 500);
                }, 2000);
            } else {
                errorMsg.textContent = 'å¯†ç¢¼éŒ¯èª¤ï¼Œå¯¶ç®±æ‹’çµ•æ‰“é–‹';
                this.classList.add('shake');
                setTimeout(() => {
                    this.classList.remove('shake');
                }, 500);
            }
        });
        
        document.getElementById('stage5Btn').addEventListener('click', function() {
            const input = document.getElementById('stage5Input').value.trim().toLowerCase();
            const errorMsg = document.getElementById('stage5Error');
            const keyEffect = document.querySelector('#stage5 .key-effect');
            if (checkAnswer('stage5', input)) {
                errorMsg.textContent = '';
                createEffect(this.parentElement, 'sparkle');
                keyEffect.style.display = 'block';
                setTimeout(() => {
                    keyEffect.classList.add('show');
                }, 10);
                this.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 300);
                setTimeout(() => {
                    switchStage(5, 6);
                    keyEffect.classList.remove('show');
                    setTimeout(() => {
                        keyEffect.style.display = 'none';
                    }, 500);
                }, 2000);
            } else {
                errorMsg.textContent = 'é€™ä¸æ˜¯é€™äº›é£Ÿç‰©çš„å…±åŒä¾†æºï¼Œå†æ€è€ƒè³¼è²·æ–°é®®é£Ÿæçš„åœ°æ–¹';
                this.classList.add('shake');
                setTimeout(() => {
                    this.classList.remove('shake');
                }, 500);
            }
        });
        
        document.getElementById('stage6Btn').addEventListener('click', function() {
            const input = document.getElementById('stage6Input').value.trim().toLowerCase();
            const errorMsg = document.getElementById('stage6Error');
            const keyEffect = document.querySelector('#stage6 .key-effect');
            if (checkAnswer('stage6', input)) {
                errorMsg.textContent = '';
                createEffect(this.parentElement, 'confetti');
                keyEffect.style.display = 'block';
                setTimeout(() => {
                    keyEffect.classList.add('show');
                }, 10);
                this.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 300);
                setTimeout(() => {
                    switchStage(6, 7);
                    keyEffect.classList.remove('show');
                    setTimeout(() => {
                        keyEffect.style.display = 'none';
                    }, 500);
                }, 2000);
            } else {
                errorMsg.textContent = 'é€™ä¸æ˜¯ä½ æ—…ç¨‹çš„èµ·é»å’Œçµ‚é»ï¼Œæ€è€ƒæ•´å€‹æ—…ç¨‹é–‹å§‹çš„åœ°æ–¹';
                this.classList.add('shake');
                setTimeout(() => {
                    this.classList.remove('shake');
                }, 500);
            }
        });
        
        document.getElementById('restartBtn').addEventListener('click', function() {
            location.reload();
        });
        
        document.querySelectorAll('.food-item').forEach(item => {
            item.addEventListener('click', function() {
                createEffect(this, 'sparkle');
                this.style.backgroundColor = 'rgba(74, 20, 140, 0.3)';
                setTimeout(() => {
                    const allSelected = Array.from(document.querySelectorAll('.food-item'))
                        .every(el => el.style.backgroundColor === 'rgba(74, 20, 140, 0.3)');
                    if (allSelected) {
                        document.getElementById('stage5Input').value = 'è¡—å¸‚';
                        document.getElementById('stage5Btn').click();
                    }
                }, 500);
            });
        });
        
        document.getElementById('activityRoom').addEventListener('click', function() {
            document.getElementById('stage3Input').value = 'æ´»å‹•å®¤';
            createEffect(this, 'sparkle');
        });
        document.getElementById('infoCenter').addEventListener('click', function() {
            document.getElementById('stage3Input').value = 'è³‡è¨Šè™•';
            createEffect(this, 'sparkle');
        });
        document.getElementById('restArea').addEventListener('click', function() {
            document.getElementById('stage3Input').value = 'å…¬åœ’';
            createEffect(this, 'sparkle');
            setTimeout(() => {
                document.getElementById('stage3Btn').click();
            }, 500);
        });
        
        document.querySelectorAll('#finalMap .location').forEach(location => {
            location.addEventListener('click', function() {
                const locationName = this.querySelector('.location-label').textContent;
                document.getElementById('stage6Input').value = locationName;
                createEffect(this, 'sparkle');
                if (locationName === 'å–„åŒ¯') {
                    setTimeout(() => {
                        document.getElementById('stage6Btn').click();
                    }, 500);
                }
            });
        });
        
        document.getElementById('phoneButton').addEventListener('click', function() {
            this.style.backgroundColor = '#555';
            setTimeout(() => {
                this.style.backgroundColor = '#333';
            }, 200);
        });
    });
</script>

</body>
</html>

