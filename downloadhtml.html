<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êô∫ËÉΩHTMLËΩâÊèõÂô® - Â¢ûÂº∑Áâà</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #27ae60;
            --warning-color: #e74c3c;
            --light-bg: #f5f6fa;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--light-bg);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .converter-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #eee;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .converter-section:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .editor-preview {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            margin: 20px 0;
        }

        @media (min-width: 768px) {
            .editor-preview {
                grid-template-columns: 1fr 1fr;
            }
        }

        textarea {
            width: 100%;
            height: 300px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            resize: vertical;
            line-height: 1.5;
        }

        .preview-container {
            position: relative;
            height: 300px;
        }

        .preview-frame {
            width: 100%;
            height: 100%;
            border: 2px solid #ddd;
            border-radius: 6px;
            background: white;
        }

        .preview-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 100;
            display: flex;
            gap: 5px;
        }

        .preview-btn {
            background: rgba(44, 62, 80, 0.7);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .preview-btn:hover {
            background: rgba(44, 62, 80, 0.9);
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        button {
            background: var(--secondary-color);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        button.success-btn {
            background: var(--accent-color);
        }

        button.success-btn:hover {
            background: #219653;
        }

        input[type="file"], 
        input[type="text"],
        select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            width: 100%;
            max-width: 400px;
            transition: border-color 0.3s ease;
        }

        input[type="file"]:focus, 
        input[type="text"]:focus,
        select:focus {
            border-color: var(--secondary-color);
            outline: none;
        }

        .modification-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid var(--secondary-color);
            transition: all 0.3s ease;
        }

        .smart-edit-section {
            display: grid;
            gap: 10px;
            grid-template-columns: 1fr auto;
            margin-bottom: 15px;
        }

        h1, h2 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filename-input {
            width: 100%;
            max-width: 300px;
            padding: 12px;
        }

        .fullscreen-preview {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 1000;
            padding: 20px;
            box-sizing: border-box;
            display: none;
        }

        .fullscreen-preview iframe {
            width: 100%;
            height: calc(100% - 60px);
            border: none;
        }

        .fullscreen-controls {
            display: flex;
            justify-content: flex-end;
            padding: 10px;
        }

        .element-navigator {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 10px;
            margin-top: 10px;
        }

        .element-item {
            padding: 8px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            transition: background 0.2s ease;
        }

        .element-item:hover {
            background: #f0f0f0;
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }

        .tab {
            padding: 10px 15px;
            cursor: pointer;
            background: #eee;
            border-radius: 6px 6px 0 0;
            border: 1px solid #ddd;
            border-bottom: none;
        }

        .tab.active {
            background: white;
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .status-bar {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 14px;
            color: #555;
        }

        .modification-history {
            max-height: 150px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 6px;
            margin-top: 10px;
        }

        .history-item {
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .history-action {
            color: var(--secondary-color);
            cursor: pointer;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìÑ Êô∫ËÉΩHTMLËΩâÊèõÂô® - Â¢ûÂº∑Áâà</h1>

        <!-- Êñá‰ª∂‰∏äÂÇ≥ÂçÄ -->
        <div class="converter-section">
            <h2>1. Êñá‰ª∂‰∏äÂÇ≥</h2>
            <div class="controls">
                <input type="file" id="fileUpload" accept=".txt,.html,.htm">
                <button onclick="document.getElementById('fileUpload').click()">
                    <span>üìÇ</span> ÈÅ∏ÊìáÊñá‰ª∂
                </button>
                <button onclick="showTemplates()">
                    <span>üìã</span> ‰ΩøÁî®Ê®°Êùø
                </button>
            </div>
        </div>

        <!-- Á∑®ËºØÈ†êË¶ΩÂçÄ -->
        <div class="converter-section">
            <h2>2. Á∑®ËºØËàáÈ†êË¶Ω</h2>
            
            <div class="tabs">
                <div class="tab active" onclick="switchTab(this, 'editorTab')">‰ª£Á¢ºÁ∑®ËºØ</div>
                <div class="tab" onclick="switchTab(this, 'elementTab')">ÂÖÉÁ¥†ÁÄèË¶Ω</div>
            </div>

            <div class="tab-content active" id="editorTab">
                <div class="editor-preview">
                    <div>
                        <h3><span>üíª</span> ‰ª£Á¢ºÁ∑®ËºØÂô®</h3>
                        <textarea id="htmlInput" placeholder="Âú®Ê≠§Ëº∏ÂÖ•ÊàñÁ≤òË≤ºHTML‰ª£Á¢º..."></textarea>
                    </div>
                    <div>
                        <h3><span>üëÅÔ∏è</span> ÂØ¶ÊôÇÈ†êË¶Ω</h3>
                        <div class="preview-container">
                            <iframe class="preview-frame" id="previewFrame"></iframe>
                            <div class="preview-controls">
                                <button class="preview-btn" onclick="toggleFullscreen()">
                                    <span>üîç</span> ÂÖ®Ëû¢Âπï
                                </button>
                                <button class="preview-btn" onclick="refreshPreview()">
                                    <span>üîÑ</span> ÈáçÊï¥
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="elementTab">
                <h3><span>üß©</span> ÂÖÉÁ¥†ÁÄèË¶ΩÂô®</h3>
                <p>ÈªûÊìäÂÖÉÁ¥†Âç≥ÂèØÂú®Á∑®ËºØÂô®‰∏≠È´ò‰∫ÆÈ°ØÁ§∫Â∞çÊáâ‰ª£Á¢º</p>
                <div class="element-navigator" id="elementNavigator">
                    <!-- ÂÖÉÁ¥†Â∞áÂú®ÈÄôË£°ÂãïÊÖãÁîüÊàê -->
                </div>
            </div>

            <div class="controls">
                <button onclick="updatePreview()">
                    <span>üîÑ</span> Êõ¥Êñ∞È†êË¶Ω
                </button>
                <button onclick="showModificationPanel()">
                    <span>üí°</span> Êô∫ËÉΩ‰øÆÊîπÂª∫Ë≠∞
                </button>
                <button onclick="validateHTML()">
                    <span>‚úÖ</span> È©óË≠âHTML
                </button>
                <button onclick="formatHTML()">
                    <span>üîß</span> Ê†ºÂºèÂåñ‰ª£Á¢º
                </button>
            </div>

            <div class="status-bar" id="statusBar">Ê∫ñÂÇôÂ∞±Á∑í„ÄÇ</div>
        </div>

        <!-- Êô∫ËÉΩ‰øÆÊîπÈù¢Êùø -->
        <div class="modification-panel" id="modificationPanel" style="display:none;">
            <h3><span>üß†</span> Êô∫ËÉΩ‰øÆÊîπÂª∫Ë≠∞ 
                <div class="tooltip">‚ÑπÔ∏è
                    <span class="tooltip-text">ÈÅ∏ÊìáÈ†êË®≠Ê®°ÂºèÊàñÊâãÂãïËº∏ÂÖ•Ë¶ÅÊü•ÊâæÁöÑÂÖßÂÆπÔºåÁÑ∂ÂæåËº∏ÂÖ•ÊõøÊèõÂÖßÂÆπ</span>
                </div>
            </h3>
            
            <div class="tabs">
                <div class="tab active" onclick="switchModTab(this, 'quickMod')">Âø´ÈÄü‰øÆÊîπ</div>
                <div class="tab" onclick="switchModTab(this, 'advancedMod')">ÈÄ≤Èöé‰øÆÊîπ</div>
                <div class="tab" onclick="switchModTab(this, 'historyMod')">‰øÆÊîπÊ≠∑Âè≤</div>
            </div>
            
            <div class="tab-content active" id="quickMod">
                <div class="smart-edit-section">
                    <select id="commonActions" onchange="handleCommonAction(this.value)">
                        <option value="">ÈÅ∏ÊìáÂø´ÈÄü‰øÆÊîπÊìç‰Ωú...</option>
                        <option value="title">‰øÆÊîπÈ†ÅÈù¢Ê®ôÈ°å</option>
                        <option value="meta">‰øÆÊîπÈ†ÅÈù¢ÊèèËø∞</option>
                        <option value="h1">‰øÆÊîπ‰∏ªÊ®ôÈ°å</option>
                        <option value="css">Â¢ûÂä†Ëá™ÂÆöÁæ©CSS</option>
                        <option value="responsive">Â¢ûÂä†ÈüøÊáâÂºèË®≠Ë®àmetaÊ®ôÁ±§</option>
                        <option value="favicon">Ê∑ªÂä†faviconÂúñÊ®ô</option>
                        <option value="footer">Ê∑ªÂä†È†ÅËÖ≥</option>
                    </select>
                    <button onclick="applyQuickModification()">ÊáâÁî®‰øÆÊîπ</button>
                </div>
                <div id="quickModContent" style="display:none;">
                    <!-- ÂãïÊÖãÁîüÊàêÁöÑË°®ÂñÆÂ∞áÂú®ÈÄôË£°È°ØÁ§∫ -->
                </div>
            </div>
            
            <div class="tab-content" id="advancedMod">
                <div class="smart-edit-section">
                    <input type="text" id="searchPattern" placeholder="Ëº∏ÂÖ•Ë¶ÅÊü•ÊâæÁöÑÂÖßÂÆπÔºàÊîØÊåÅÊ≠£ÂâáË°®ÈÅîÂºèÔºâ">
                    <select id="commonPatterns" onchange="fillSearchPattern(this.value)">
                        <option value="">Â∏∏Áî®Ê®°Âºè...</option>
                        <option value="<title>.*?</title>">È†ÅÈù¢Ê®ôÈ°å</option>
                        <option value="<meta name=\"description\".*?>">È†ÅÈù¢ÊèèËø∞</option>
                        <option value="<h1>.*?</h1>">‰∏ªÊ®ôÈ°å</option>
                        <option value="<link.*?rel=\"stylesheet\".*?>">CSSÈèàÊé•</option>
                        <option value="<div class=\".*?\">">DIVËàáÁâπÂÆöÈ°û</option>
                        <option value="<img.*?src=\".*?\".*?>">ÂúñÁâáÊ®ôÁ±§</option>
                    </select>
                </div>
                <div class="smart-edit-section">
                    <input type="text" id="replaceContent" placeholder="Ëº∏ÂÖ•ÊõøÊèõÂÖßÂÆπ...">
                    <button onclick="applyModification()">ÊáâÁî®‰øÆÊîπ</button>
                </div>
            </div>
            
            <div class="tab-content" id="historyMod">
                <h4>‰øÆÊîπÊ≠∑Âè≤Ë®òÈåÑ</h4>
                <div class="modification-history" id="modificationHistory">
                    <!-- Ê≠∑Âè≤Ë®òÈåÑÂ∞áÂú®ÈÄôË£°ÂãïÊÖãÁîüÊàê -->
                    <div class="history-item">Â∞öÁÑ°‰øÆÊîπË®òÈåÑ</div>
                </div>
            </div>
        </div>

        <!-- Ëº∏Âá∫Ë®≠ÁΩÆ -->
        <div class="converter-section">
            <h2>3. Ëº∏Âá∫Ë®≠ÁΩÆ</h2>
            <div class="controls">
                <input type="text" id="customName" 
                       class="filename-input"
                       placeholder="Ëá™ÂÆöÁæ©Êñá‰ª∂ÂêçÔºàÈªòË™çÔºöconverted.htmlÔºâ">
                <button class="success-btn" onclick="downloadFile()">
                    <span>üíæ</span> ‰øùÂ≠òÊñá‰ª∂
                </button>
                <button onclick="copyToClipboard()">
                    <span>üìã</span> Ë§áË£ΩÂà∞Ââ™Ë≤ºÊùø
                </button>
            </div>
        </div>
    </div>

    <!-- ÂÖ®Ëû¢ÂπïÈ†êË¶ΩÊ®°Âºè -->
    <div class="fullscreen-preview" id="fullscreenPreview">
        <div class="fullscreen-controls">
            <button onclick="exitFullscreen()" class="preview-btn">
                <span>‚ùå</span> ÈÄÄÂá∫ÂÖ®Ëû¢Âπï
            </button>
        </div>
        <iframe id="fullscreenFrame"></iframe>
    </div>

    <script>
        let modificationHistory = [];
        let autoSaveInterval;
        let lastSavedContent = '';

        // ÂàùÂßãÂåñ
        window.onload = function() {
            updatePreview();
            setAutoSave();
        };

        // Ëá™Âãï‰øùÂ≠òÂäüËÉΩ
        function setAutoSave() {
            autoSaveInterval = setInterval(function() {
                const currentContent = document.getElementById('htmlInput').value;
                if (currentContent !== lastSavedContent) {
                    localStorage.setItem('htmlConverterContent', currentContent);
                    lastSavedContent = currentContent;
                    updateStatus('Ëá™Âãï‰øùÂ≠òÂÆåÊàê...');
                }
            }, 30000); // ÊØè30ÁßíËá™Âãï‰øùÂ≠ò‰∏ÄÊ¨°
            
            // ÂòóË©¶ÊÅ¢Âæ©‰∏äÊ¨°Á∑®ËºØ
            const savedContent = localStorage.getItem('htmlConverterContent');
            if (savedContent) {
                document.getElementById('htmlInput').value = savedContent;
                updatePreview();
                updateStatus('Â∑≤ÊÅ¢Âæ©‰∏äÊ¨°Á∑®ËºØÁöÑÂÖßÂÆπ');
            }
        }

        // Êñá‰ª∂‰∏äÂÇ≥ËôïÁêÜ
        document.getElementById('fileUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('htmlInput').value = e.target.result;
                updatePreview();
                autoSetFilename(file.name);
                updateElementNavigator();
                updateStatus(`Â∑≤ËºâÂÖ•Êñá‰ª∂: ${file.name}`);
            };
            reader.readAsText(file);
        });

        // ÂØ¶ÊôÇÈ†êË¶ΩÊõ¥Êñ∞
        function updatePreview() {
            const content = document.getElementById('htmlInput').value;
            const previewFrame = document.getElementById('previewFrame');
            previewFrame.srcdoc = sanitizeContent(content);
            setTimeout(updateElementNavigator, 1000); // Á≠âÂæÖiframeËºâÂÖ•ÂæåÊõ¥Êñ∞ÂÖÉÁ¥†Â∞éËà™
            updateStatus('È†êË¶ΩÂ∑≤Êõ¥Êñ∞');
        }

        // Âà∑Êñ∞È†êË¶Ω
        function refreshPreview() {
            const previewFrame = document.getElementById('previewFrame');
            previewFrame.srcdoc = previewFrame.srcdoc;
            updateStatus('È†êË¶ΩÂ∑≤ÈáçÊï¥');
        }

        // ÂÆâÂÖ®ÈÅéÊøæ
        function sanitizeContent(content) {
            return content
                .replace(/<script\b[^>]*>([\s\S]*?)<\/script>/gi, '<!-- ËÖ≥Êú¨Ë¢´ÁßªÈô§‰ª•Á¢∫‰øùÂÆâÂÖ® -->')
                .replace(/ on\w+="[^"]*"/gi, '');
        }

        // Ëá™ÂãïË®≠ÁΩÆÊñá‰ª∂Âêç
        function autoSetFilename(originalName) {
            const cleanName = originalName.replace(/\.[^/.]+$/, "");
            document.getElementById('customName').value = cleanName || 'converted';
        }

        // Êõ¥Êñ∞ÁãÄÊÖãÊ¨Ñ
        function updateStatus(message) {
            const statusBar = document.getElementById('statusBar');
            statusBar.textContent = message;
            setTimeout(() => {
                statusBar.textContent = 'Ê∫ñÂÇôÂ∞±Á∑í„ÄÇ';
            }, 3000);
        }

        // ÂàáÊèõÈÅ∏È†ÖÂç°
        function switchTab(tabElement, tabId) {
            // Èö±ËóèÊâÄÊúâÈÅ∏È†ÖÂç°
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // È°ØÁ§∫ÈÅ∏‰∏≠ÁöÑÈÅ∏È†ÖÂç°
            tabElement.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // ÂàáÊèõ‰øÆÊîπÈÅ∏È†ÖÂç°
        function switchModTab(tabElement, tabId) {
            // Èö±ËóèÊâÄÊúâ‰øÆÊîπÈÅ∏È†ÖÂç°
            document.querySelectorAll('#modificationPanel .tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('#modificationPanel .tab-content').forEach(content => {
                content.classList.remove('active');
                content.style.display = 'none';
            });
            
            // È°ØÁ§∫ÈÅ∏‰∏≠ÁöÑ‰øÆÊîπÈÅ∏È†ÖÂç°
            tabElement.classList.add('active');
            document.getElementById(tabId).style.display = 'block';
            document.getElementById(tabId).classList.add('active');
        }

        // ÂÖ®Ëû¢ÂπïÈ†êË¶Ω
        function toggleFullscreen() {
            const fullscreenPreview = document.getElementById('fullscreenPreview');
            const fullscreenFrame = document.getElementById('fullscreenFrame');
            const content = document.getElementById('htmlInput').value;
            
            fullscreenFrame.srcdoc = sanitizeContent(content);
            fullscreenPreview.style.display = 'block';
            updateStatus('Â∑≤ÂàáÊèõËá≥ÂÖ®Ëû¢ÂπïÈ†êË¶ΩÊ®°Âºè');
        }

        // ÈÄÄÂá∫ÂÖ®Ëû¢Âπï
        function exitFullscreen() {
            document.getElementById('fullscreenPreview').style.display = 'none';
            updateStatus('Â∑≤ÈÄÄÂá∫ÂÖ®Ëû¢ÂπïÈ†êË¶Ω');
        }

        // Êô∫ËÉΩ‰øÆÊîπÈù¢Êùø
        function showModificationPanel() {
            document.getElementById('modificationPanel').style.display = 'block';
            updateStatus('Êô∫ËÉΩ‰øÆÊîπÈù¢ÊùøÂ∑≤ÈñãÂïü');
        }

        // Â°´ÂÖÖÊêúÁ¥¢Ê®°Âºè
        function fillSearchPattern(value) {
            if (value) document.getElementById('searchPattern').value = value;
        }

        // ËôïÁêÜÂ∏∏Áî®‰øÆÊîπ
        function handleCommonAction(action) {
            const quickModContent = document.getElementById('quickModContent');
            
            if (!action) {
                quickModContent.style.display = 'none';
                return;
            }
            
            let html = '';
            
            switch(action) {
                case 'title':
                    html = `
                        <div style="margin-top:15px;">
                            <label for="newTitle">Êñ∞È†ÅÈù¢Ê®ôÈ°å:</label>
                            <input type="text" id="newTitle" style="width:100%;margin-top:5px;" placeholder="Ëº∏ÂÖ•Êñ∞ÁöÑÈ†ÅÈù¢Ê®ôÈ°å">
                        </div>
                    `;
                    break;
                case 'meta':
                    html = `
                        <div style="margin-top:15px;">
                            <label for="newDescription">Êñ∞È†ÅÈù¢ÊèèËø∞:</label>
                            <input type="text" id="newDescription" style="width:100%;margin-top:5px;" placeholder="Ëº∏ÂÖ•Êñ∞ÁöÑÈ†ÅÈù¢ÊèèËø∞">
                        </div>
                    `;
                    break;
                case 'h1':
                    html = `
                        <div style="margin-top:15px;">
                            <label for="newHeading">Êñ∞‰∏ªÊ®ôÈ°å:</label>
                            <input type="text" id="newHeading" style="width:100%;margin-top:5px;" placeholder="Ëº∏ÂÖ•Êñ∞ÁöÑ‰∏ªÊ®ôÈ°å">
                        </div>
                    `;
                    break;
                case 'css':
                    html = `
                        <div style="margin-top:15px;">
                            <label for="customCSS">Ëá™ÂÆöÁæ©CSS:</label>
                            <textarea id="customCSS" style="width:100%;height:100px;margin-top:5px;" placeholder="Ëº∏ÂÖ•Ëá™ÂÆöÁæ©CSSÊ®£Âºè"></textarea>
                        </div>
                    `;
                    break;
                case 'responsive':
                    html = `
                        <div style="margin-top:15px;">
                            <p>Â∞áÊ∑ªÂä†‰ª•‰∏ãÈüøÊáâÂºèË®≠Ë®àmetaÊ®ôÁ±§:</p>
                            <code>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</code>
                        </div>
                    `;
                    break;
                case 'favicon':
                    html = `
                        <div style="margin-top:15px;">
                            <label for="faviconURL">Favicon URL:</label>
                            <input type="text" id="faviconURL" style="width:100%;margin-top:5px;" placeholder="Ëº∏ÂÖ•faviconÁöÑURL">
                        </div>
                    `;
                    break;
                case 'footer':
                    html = `
                        <div style="margin-top:15px;">
                            <label for="footerContent">È†ÅËÖ≥ÂÖßÂÆπ:</label>
                            <textarea id="footerContent" style="width:100%;height:80px;margin-top:5px;" placeholder="Ëº∏ÂÖ•È†ÅËÖ≥ÂÖßÂÆπ"></textarea>
                        </div>
                    `;
                    break;
            }
            
            quickModContent.innerHTML = html;
            quickModContent.style.display = 'block';
        }

        // ÊáâÁî®Âø´ÈÄü‰øÆÊîπ
        function applyQuickModification() {
            const action = document.getElementById('commonActions').value;
            if (!action) {
                alert('Ë´ãÈÅ∏Êìá‰∏ÄÂÄã‰øÆÊîπÊìç‰Ωú');
                return;
            }
            
            const editor = document.getElementById('htmlInput');
            let content = editor.value;
            let modification = '';
            let description = '';
            
            switch(action) {
                case 'title':
                    const newTitle = document.getElementById('newTitle').value;
                    if (!newTitle) {
                        alert('Ë´ãËº∏ÂÖ•Êñ∞ÁöÑÈ†ÅÈù¢Ê®ôÈ°å');
                        return;
                    }
                    
                    if (content.includes('<title>')) {
                        content = content.replace(/<title>.*?<\/title>/i, `<title>${newTitle}</title>`);
                    } else if (content.includes('<head>')) {
                        content = content.replace(/<head>/i, `<head>\n  <title>${newTitle}</title>`);
                    } else {
                        alert('ÁÑ°Ê≥ïÊâæÂà∞ÈÅ©ÂêàÊèíÂÖ•Ê®ôÈ°åÁöÑ‰ΩçÁΩÆÔºåË´ãÁ¢∫‰øùHTMLÂåÖÂê´headÊ®ôÁ±§');
                        return;
                    }
                    
                    modification = `<title>${newTitle}</title>`;
                    description = `Êõ¥Êñ∞È†ÅÈù¢Ê®ôÈ°åÁÇ∫: ${newTitle}`;
                    break;
                    
                case 'meta':
                    const newDescription = document.getElementById('newDescription').value;
                    if (!newDescription) {
                        alert('Ë´ãËº∏ÂÖ•Êñ∞ÁöÑÈ†ÅÈù¢ÊèèËø∞');
                        return;
                    }
                    
                    const metaTag = `<meta name="description" content="${newDescription}">`;
                    
                    if (content.includes('<meta name="description"')) {
                        content = content.replace(/<meta name="description".*?>/i, metaTag);
                    } else if (content.includes('<head>')) {
                        content = content.replace(/<head>/i, `<head>\n  ${metaTag}`);
                    } else {
                        alert('ÁÑ°Ê≥ïÊâæÂà∞ÈÅ©ÂêàÊèíÂÖ•ÊèèËø∞ÁöÑ‰ΩçÁΩÆÔºåË´ãÁ¢∫‰øùHTMLÂåÖÂê´headÊ®ôÁ±§');
                        return;
                    }
                    
                    modification = metaTag;
                    description = `Êõ¥Êñ∞È†ÅÈù¢ÊèèËø∞`;
                    break;
                    
                case 'h1':
                    const newHeading = document.getElementById('newHeading').value;
                    if (!newHeading) {
                        alert('Ë´ãËº∏ÂÖ•Êñ∞ÁöÑ‰∏ªÊ®ôÈ°å');
                        return;
                    }
                    
                    if (content.includes('<h1>')) {
                        content = content.replace(/<h1>.*?<\/h1>/i, `<h1>${newHeading}</h1>`);
                    } else if (content.includes('<body>')) {
                        content = content.replace(/<body>/i, `<body>\n  <h1>${newHeading}</h1>`);
                    } else {
                        alert('ÁÑ°Ê≥ïÊâæÂà∞ÈÅ©ÂêàÊèíÂÖ•Ê®ôÈ°åÁöÑ‰ΩçÁΩÆÔºåË´ãÁ¢∫‰øùHTMLÁµêÊßãÊ≠£Á¢∫');
                        return;
                    }
                    
                    modification = `<h1>${newHeading}</h1>`;
                    description = `Êõ¥Êñ∞‰∏ªÊ®ôÈ°åÁÇ∫: ${newHeading}`;
                    break;
                    
                case 'css':
                    const customCSS = document.getElementById('customCSS').value;
                    if (!customCSS) {
                        alert('Ë´ãËº∏ÂÖ•Ëá™ÂÆöÁæ©CSSÊ®£Âºè');
                        return;
                    }
                    
                    const styleTag = `<style>\n${customCSS}\n</style>`;
                    
                    if (content.includes('</head>')) {
                        content = content.replace(/<\/head>/i, `  ${styleTag}\n</head>`);
                    } else {
                        alert('ÁÑ°Ê≥ïÊâæÂà∞ÈÅ©ÂêàÊèíÂÖ•CSSÁöÑ‰ΩçÁΩÆÔºåË´ãÁ¢∫‰øùHTMLÂåÖÂê´headÊ®ôÁ±§');
                        return;
                    }
                    
                    modification = styleTag;
                    description = 'Ê∑ªÂä†Ëá™ÂÆöÁæ©CSSÊ®£Âºè';
                    break;
                    
                case 'responsive':
                    const viewportMeta = '<meta name="viewport" content="width=device-width, initial-scale=1.0">';
                    
                    if (content.includes('name="viewport"')) {
                        alert('È†ÅÈù¢Â∑≤ÂåÖÂê´viewportË®≠ÁΩÆ');
                        return;
                    }
                    
                    if (content.includes('<head>')) {
                        content = content.replace(/<head>/i, `<head>\n  ${viewportMeta}`);
                    } else {
                        alert('ÁÑ°Ê≥ïÊâæÂà∞ÈÅ©ÂêàÊèíÂÖ•metaÊ®ôÁ±§ÁöÑ‰ΩçÁΩÆÔºåË´ãÁ¢∫‰øùHTMLÂåÖÂê´headÊ®ôÁ±§');
                        return;
                    }
                    
                    modification = viewportMeta;
                    description = 'Ê∑ªÂä†ÈüøÊáâÂºèË®≠Ë®àmetaÊ®ôÁ±§';
                    break;
                    
                case 'favicon':
                    const faviconURL = document.getElementById('faviconURL').value;
                    if (!faviconURL) {
                        alert('Ë´ãËº∏ÂÖ•faviconÁöÑURL');
                        return;
                    }
                    
                    const faviconLink = `<link rel="icon" href="${faviconURL}">`;
                    
                    if (content.includes('</head>')) {
                        content = content.replace(/<\/head>/i, `  ${faviconLink}\n</head>`);
                    } else {
                        alert('ÁÑ°Ê≥ïÊâæÂà∞ÈÅ©ÂêàÊèíÂÖ•faviconÁöÑ‰ΩçÁΩÆÔºåË´ãÁ¢∫‰øùHTMLÂåÖÂê´headÊ®ôÁ±§');
                        return;
                    }
                    
                    modification = faviconLink;
                    description = 'Ê∑ªÂä†faviconÂúñÊ®ô';
                    break;
                    
                case 'footer':
                    const footerContent = document.getElementById('footerContent').value;
                    if (!footerContent) {
                        alert('Ë´ãËº∏ÂÖ•È†ÅËÖ≥ÂÖßÂÆπ');
                        return;
                    }
                    
                    const footerHtml = `<footer style="margin-top: 20px; padding: 10px; border-top: 1px solid #eee; text-align: center;">\n  ${footerContent}\n</footer>`;
                    
                    if (content.includes('</body>')) {
                        content = content.replace(/<\/body>/i, `${footerHtml}\n</body>`);
                    } else {
                        alert('ÁÑ°Ê≥ïÊâæÂà∞ÈÅ©ÂêàÊèíÂÖ•È†ÅËÖ≥ÁöÑ‰ΩçÁΩÆÔºåË´ãÁ¢∫‰øùHTMLÂåÖÂê´bodyÊ®ôÁ±§');
                        return;
                    }
                    
                    modification = footerHtml;
                    description = 'Ê∑ªÂä†È†ÅËÖ≥ÂÖßÂÆπ';
                    break;
            }
            
            editor.value = content;
            updatePreview();
            addToHistory(description, modification);
            updateStatus(`Â∑≤ÊàêÂäü${description}`);
        }

        // ÈÄ≤Èöé‰øÆÊîπÂäüËÉΩ
        function applyModification() {
            const search = document.getElementById('searchPattern').value;
            const replace = document.getElementById('replaceContent').value;
            const editor = document.getElementById('htmlInput');
            
            if (!search) {
                alert('Ë´ãËº∏ÂÖ•Ë¶ÅÊü•ÊâæÁöÑÂÖßÂÆπÔºÅ');
                return;
            }

            try {
                const regex = new RegExp(search, 'gi');
                const matches = editor.value.match(regex);
                
                if (!matches) {
                    if (confirm('Êú™ÊâæÂà∞ÂåπÈÖçÂÖßÂÆπÔºåÊòØÂê¶Âú®Êñá‰ª∂Êú´Â∞æÊ∑ªÂä†Êñ∞ÂÖßÂÆπÔºü')) {
                        editor.value += `\n${replace}`;
                        addToHistory('Ê∑ªÂä†Êñ∞ÂÖßÂÆπ', replace);
                    }
                    return;
                }

                if (confirm(`ÊâæÂà∞ ${matches.length} ËôïÂåπÈÖçÔºåÊòØÂê¶ÂÖ®ÈÉ®ÊõøÊèõÔºü`)) {
                    const oldContent = editor.value;
                    editor.value = editor.value.replace(regex, replace);
                    updatePreview();
                    addToHistory(`ÊõøÊèõ ${matches.length} ËôïÂÖßÂÆπ`, `${search} ‚Üí ${replace}`);
                }
            } catch (e) {
                alert('Ê≠£ÂâáË°®ÈÅîÂºèÈåØË™§Ôºö' + e.message);
            }
        }

        // Ê∑ªÂä†‰øÆÊîπÊ≠∑Âè≤
        function addToHistory(action, details) {
            const timestamp = new Date().toLocaleTimeString();
            modificationHistory.unshift({
                action: action,
                details: details,
                timestamp: timestamp
            });
            
            // ÈôêÂà∂Ê≠∑Âè≤Ë®òÈåÑÊï∏Èáè
            if (modificationHistory.length > 20) {
                modificationHistory.pop();
            }
            
            updateHistoryDisplay();
        }

        // Êõ¥Êñ∞Ê≠∑Âè≤È°ØÁ§∫
        function updateHistoryDisplay() {
            const historyContainer = document.getElementById('modificationHistory');
            
            if (modificationHistory.length === 0) {
                historyContainer.innerHTML = '<div class="history-item">Â∞öÁÑ°‰øÆÊîπË®òÈåÑ</div>';
                return;
            }
            
            let html = '';
            modificationHistory.forEach((item, index) => {
                html += `
                    <div class="history-item">
                        <span>${item.timestamp}: ${item.action}</span>
                        <span class="history-action" onclick="revertChange(${index})">Êí§Èä∑</span>
                    </div>
                `;
            });
            
            historyContainer.innerHTML = html;
        }

        // Êí§Èä∑‰øÆÊîπÔºàÁ∞°ÂñÆÂØ¶ÁèæÔºåÂØ¶Èöõ‰∏äÈúÄË¶Å‰øùÂ≠òÊØèÊ¨°‰øÆÊîπÁöÑÂÆåÊï¥ÂÖßÂÆπÊâçËÉΩÊ∫ñÁ¢∫Êí§Èä∑Ôºâ
        function revertChange(index) {
            if (confirm('Á¢∫ÂÆöË¶ÅÊí§Èä∑Ê≠§‰øÆÊîπÂóéÔºü\nÊ≥®ÊÑèÔºöÈÄôÊòØ‰∏ÄÂÄãÁ∞°ÂåñÁöÑÊí§Èä∑ÂäüËÉΩÔºåÂèØËÉΩÁÑ°Ê≥ïÊ∫ñÁ¢∫ÊÅ¢Âæ©„ÄÇ')) {
                modificationHistory.splice(index, 1);
                updateHistoryDisplay();
                updateStatus('Â∑≤ÂòóË©¶Êí§Èä∑‰øÆÊîπ');
            }
        }

        // Êõ¥Êñ∞ÂÖÉÁ¥†Â∞éËà™Âô®
        function updateElementNavigator() {
            const previewFrame = document.getElementById('previewFrame');
            const elementNavigator = document.getElementById('elementNavigator');
            
            if (!previewFrame.contentWindow.document.body) {
                elementNavigator.innerHTML = '<div class="element-item">È†êË¶ΩÂ∞öÊú™ËºâÂÖ•</div>';
                return;
            }
            
            try {
                const elements = [];
                
                // Êî∂ÈõÜÈáçË¶ÅÂÖÉÁ¥†
                const headings = Array.from(previewFrame.contentWindow.document.querySelectorAll('h1, h2, h3'));
                const divs = Array.from(previewFrame.contentWindow.document.querySelectorAll('div[class], div[id]'));
                const links = Array.from(previewFrame.contentWindow.document.querySelectorAll('a[href]'));
                const images = Array.from(previewFrame.contentWindow.document.querySelectorAll('img'));
                
                headings.forEach(el => elements.push({
                    type: el.tagName.toLowerCase(),
                    content: el.textContent.trim().substring(0, 30),
                    selector: getElementSelector(el)
                }));
                
                divs.slice(0, 10).forEach(el => elements.push({
                    type: 'div',
                    content: (el.className || el.id || '').substring(0, 30),
                    selector: getElementSelector(el)
                }));
                
                links.slice(0, 5).forEach(el => elements.push({
                    type: 'a',
                    content: el.textContent.trim().substring(0, 30) || el.href,
                    selector: getElementSelector(el)
                }));
                
                images.slice(0, 5).forEach(el => elements.push({
                    type: 'img',
                    content: el.alt || el.src.split('/').pop(),
                    selector: getElementSelector(el)
                }));
                
                // ÁîüÊàêÂÖÉÁ¥†ÂàóË°®
                let html = '';
                elements.forEach(el => {
                    html += `
                        <div class="element-item" onclick="highlightElement('${el.selector}')">
                            &lt;${el.type}&gt; ${el.content || '[ÁÑ°ÂÖßÂÆπ]'}
                        </div>
                    `;
                });
                
                elementNavigator.innerHTML = html || '<div class="element-item">Êú™ÊâæÂà∞ÂÖÉÁ¥†</div>';
            } catch (e) {
                elementNavigator.innerHTML = `<div class="element-item">ËºâÂÖ•ÂÖÉÁ¥†ÊôÇÂá∫ÈåØ: ${e.message}</div>`;
            }
        }

        // Áç≤ÂèñÂÖÉÁ¥†ÈÅ∏ÊìáÂô®
        function getElementSelector(el) {
            // Á∞°ÂñÆÂØ¶ÁèæÔºåÂØ¶ÈöõÊáâÁî®‰∏≠ÊáâË©≤ÊúâÊõ¥Ë§áÈõúÁöÑÁÆóÊ≥ï‰æÜÁ¢∫ÂÆöÂîØ‰∏ÄÈÅ∏ÊìáÂô®
            if (el.id) return `#${el.id}`;
            if (el.className) return `.${el.className.split(' ')[0]}`;
            
            let selector = el.tagName.toLowerCase();
            if (el.textContent && el.textContent.trim()) {
                selector += `:contains("${el.textContent.trim().substring(0, 20)}")`;
            }
            
            return selector;
        }

        // È´ò‰∫ÆÂÖÉÁ¥†Â∞çÊáâÁöÑ‰ª£Á¢º
        function highlightElement(selector) {
            const editor = document.getElementById('htmlInput');
            const content = editor.value;
            
            // Á∞°ÂñÆÂØ¶ÁèæÔºåÂØ¶Èöõ‰∏äÈúÄË¶ÅÊõ¥Ë§áÈõúÁöÑËß£Êûê‰æÜÊ∫ñÁ¢∫ÂÆö‰Ωç
            let searchPattern;
            
            if (selector.startsWith('#')) {
                searchPattern = `id="${selector.substring(1)}"`;
            } else if (selector.startsWith('.')) {
                searchPattern = `class="[^"]*${selector.substring(1)}[^"]*"`;
            } else if (selector.includes(':contains(')) {
                const parts = selector.split(':contains("');
                const tag = parts[0];
                const text = parts[1].replace('")', '');
                searchPattern = `<${tag}[^>]*>[^<]*${text}`;
            } else {
                searchPattern = `<${selector}[^>]*>`;
            }
            
            try {
                const regex = new RegExp(searchPattern, 'i');
                const match = regex.exec(content);
                
                if (match) {
                    editor.focus();
                    editor.setSelectionRange(match.index, match.index + match[0].length);
                    
                    // ÊªæÂãïÂà∞ÈÅ∏‰∏≠‰ΩçÁΩÆ
                    const lineHeight = 16; // ‰º∞Ë®àÁöÑË°åÈ´ò
                    const linesBeforeMatch = content.substr(0, match.index).split('\n').length - 1;
                    editor.scrollTop = linesBeforeMatch * lineHeight;
                    
                    updateStatus(`Â∑≤ÊâæÂà∞‰∏¶ÈÅ∏‰∏≠ÂÖÉÁ¥† ${selector}`);
                } else {
                    updateStatus(`ÁÑ°Ê≥ïÊâæÂà∞ÂÖÉÁ¥† ${selector} Â∞çÊáâÁöÑ‰ª£Á¢º`);
                }
            } catch (e) {
                updateStatus(`Êü•ÊâæÂÖÉÁ¥†ÊôÇÂá∫ÈåØ: ${e.message}`);
            }
        }

        // È©óË≠âHTML
        function validateHTML() {
            const content = document.getElementById('htmlInput').value;
            if (!content.trim()) {
                updateStatus('Ê≤íÊúâÂÖßÂÆπÂèØ‰æõÈ©óË≠â');
                return;
            }
            
            // Á∞°ÂñÆÊ™¢Êü•
            const errors = [];
            
            // Ê™¢Êü•Âü∫Êú¨ÁµêÊßã
            if (!content.includes('<!DOCTYPE')) {
                errors.push('Áº∫Â∞ëDOCTYPEËÅ≤Êòé');
            }
            
            if (!content.includes('<html>') && !content.includes('<html ')) {
                errors.push('Áº∫Â∞ëHTMLÊ®ôÁ±§');
            }
            
            if (!content.includes('<head>')) {
                errors.push('Áº∫Â∞ëHEADÊ®ôÁ±§');
            }
            
            if (!content.includes('<body>')) {
                errors.push('Áº∫Â∞ëBODYÊ®ôÁ±§');
            }
            
            // Ê™¢Êü•Ê®ôÁ±§Âπ≥Ë°°
            const openTags = content.match(/<[a-z][a-z0-9]*(?:\s[^>]*)?>/gi) || [];
            const closeTags = content.match(/<\/[a-z][a-z0-9]*>/gi) || [];
            
            if (openTags.length - closeTags.length !== 0) {
                errors.push('Ê®ôÁ±§Êï∏Èáè‰∏çÂπ≥Ë°°ÔºåÂèØËÉΩÊúâÊú™ÈñâÂêàÁöÑÊ®ôÁ±§');
            }
            
            // È°ØÁ§∫ÁµêÊûú
            if (errors.length === 0) {
                alert('HTMLÈ©óË≠âÊàêÂäüÔºÅÊ≤íÊúâÁôºÁèæÊòéÈ°ØÈåØË™§„ÄÇ');
                updateStatus('HTMLÈ©óË≠âÈÄöÈÅé');
            } else {
                alert(`HTMLÈ©óË≠âÁôºÁèæ ${errors.length} ÂÄãÂïèÈ°å:\n\n${errors.join('\n')}`);
                updateStatus(`È©óË≠âÁôºÁèæ ${errors.length} ÂÄãÂïèÈ°å`);
            }
        }

        // Ê†ºÂºèÂåñHTML
        function formatHTML() {
            const content = document.getElementById('htmlInput').value;
            if (!content.trim()) {
                updateStatus('Ê≤íÊúâÂÖßÂÆπÂèØ‰æõÊ†ºÂºèÂåñ');
                return;
            }
            
            try {
                // Á∞°ÂñÆÊ†ºÂºèÂåñ
                let formatted = '';
                let indent = 0;
                let newLine = true;
                
                // ÁâπÊÆäËôïÁêÜÂ≠óÁ¨¶
                const specialChars = ['<', '>', '\n'];
                let inTag = false;
                let inComment = false;
                let inPreTag = false;
                
                for (let i = 0; i < content.length; i++) {
                    const char = content[i];
                    
                    // ËôïÁêÜË®ªÈáã
                    if (i < content.length - 3 && content.substring(i, i + 4) === '<!--') {
                        inComment = true;
                        formatted += '<!--';
                        i += 3;
                        continue;
                    }
                    
                    if (inComment && i < content.length - 2 && content.substring(i, i + 3) === '-->') {
                        inComment = false;
                        formatted += '-->';
                        i += 2;
                        formatted += '\n' + ' '.repeat(indent);
                        continue;
                    }
                    
                    if (inComment) {
                        formatted += char;
                        continue;
                    }
                    
                    // ËôïÁêÜpreÊ®ôÁ±§
                    if (i < content.length - 4 && content.substring(i, i + 5).toLowerCase() === '<pre>') {
                        inPreTag = true;
                    }
                    
                    if (inPreTag && i < content.length - 5 && content.substring(i, i + 6).toLowerCase() === '</pre>') {
                        inPreTag = false;
                    }
                    
                    if (inPreTag) {
                        formatted += char;
                        continue;
                    }
                    
                    // ËôïÁêÜÊ®ôÁ±§
                    if (char === '<' && !inTag) {
                        inTag = true;
                        
                        // ËôïÁêÜÈñâÂêàÊ®ôÁ±§Á∏ÆÈÄ≤
                        if (i < content.length - 1 && content[i + 1] === '/') {
                            indent -= 2;
                            if (indent < 0) indent = 0;
                        }
                        
                        if (newLine) {
                            formatted += ' '.repeat(indent);
                            newLine = false;
                        }
                        
                        formatted += '<';
                    } else if (char === '>' && inTag) {
                        inTag = false;
                        formatted += '>';
                        
                        // ËôïÁêÜËá™ÈñâÂêàÊ®ôÁ±§‰∏çÂ¢ûÂä†Á∏ÆÈÄ≤
                        if (i > 0 && content[i - 1] === '/') {
                            // ‰∏çÂ¢ûÂä†Á∏ÆÈÄ≤
                        } 
                        // ËôïÁêÜÈñãÂßãÊ®ôÁ±§Â¢ûÂä†Á∏ÆÈÄ≤
                        else if (i > 0 && content[i - 1] !== '/') {
                            // ÊâæÂà∞Ê®ôÁ±§Âêç
                            let j = i - 1;
                            while (j >= 0 && content[j] !== '<') j--;
                            
                            if (j >= 0) {
                                const tagContent = content.substring(j, i + 1);
                                // ÊéíÈô§Ëá™ÈñâÂêàÊ®ôÁ±§ÂíåÁÑ°ÂÖßÂÆπÊ®ôÁ±§
                                if (!tagContent.match(/<(meta|link|img|br|hr|input|source)(\s|>)/i)) {
                                    indent += 2;
                                }
                            }
                        }
                        
                        formatted += '\n';
                        newLine = true;
                    } else {
                        if (newLine && !inTag && char !== '\n') {
                            formatted += ' '.repeat(indent);
                            newLine = false;
                        }
                        
                        if (char === '\n') {
                            if (!inTag) newLine = true;
                            // ÂøΩÁï•ÂéüÊñá‰ª∂‰∏≠ÁöÑÊèõË°åÔºåÈô§ÈùûÂú®Ê®ôÁ±§Â§ñ
                            if (!inTag) formatted += '\n';
                        } else {
                            formatted += char;
                        }
                    }
                }
                
                document.getElementById('htmlInput').value = formatted;
                updatePreview();
                addToHistory('Ê†ºÂºèÂåñHTML', '‰ª£Á¢ºÂ∑≤Ê†ºÂºèÂåñ');
                updateStatus('HTML‰ª£Á¢ºÂ∑≤Ê†ºÂºèÂåñ');
            } catch (e) {
                alert('Ê†ºÂºèÂåñÈÅéÁ®ã‰∏≠Âá∫ÈåØ: ' + e.message);
                updateStatus('Ê†ºÂºèÂåñÂ§±Êïó');
            }
        }

        // Êñá‰ª∂‰∏ãËºâËôïÁêÜ
        function downloadFile() {
            const content = document.getElementById('htmlInput').value;
            const customName = document.getElementById('customName').value;
            const filename = `${customName.replace(/[^a-zA-Z0-9\u4e00-\u9fa5\-_]/g, '_')}.html`;

            const blob = new Blob([content], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            updateStatus(`Â∑≤‰∏ãËºâÊñá‰ª∂: ${filename}`);
        }

        // Ë§áË£ΩÂà∞Ââ™Ë≤ºÊùø
        function copyToClipboard() {
            const content = document.getElementById('htmlInput').value;
            navigator.clipboard.writeText(content)
                .then(() => {
                    updateStatus('Â∑≤Ë§áË£ΩÂà∞Ââ™Ë≤ºÊùø');
                })
                .catch(err => {
                    alert('Ë§áË£ΩÂ§±Êïó: ' + err);
                    updateStatus('Ë§áË£ΩÂ§±Êïó');
                });
        }

        // ‰ΩøÁî®Ê®°Êùø
        function showTemplates() {
            const templates = [
                {
                    name: 'Âü∫Êú¨HTML5Ê®°Êùø',
                    code: `<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊàëÁöÑÁ∂≤È†Å</title>
    <style>
        body {
            font-family: 'ÂæÆËªüÊ≠£ÈªëÈ´î', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Á∂≤È†ÅÊ®ôÈ°å</h1>
        </header>
        <main>
            <p>ÈÄôÊòØ‰∏ÄÂÄãÂü∫Êú¨ÁöÑHTML5Ê®°Êùø„ÄÇ</p>
        </main>
        <footer>
            <p>&copy; 2025 ÊàëÁöÑÁ∂≤Á´ô</p>
        </footer>
    </div>
</body>
</html>`
                },
                {
                    name: 'Á∞°ÂñÆÊñáÁ´†È†ÅÈù¢',
                    code: `<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊñáÁ´†Ê®ôÈ°å</title>
    <style>
        body {
            font-family: 'ÂæÆËªüÊ≠£ÈªëÈ´î', Arial, sans-serif;
            margin: 0;
            padding: 0;
            line-height: 1.8;
            color: #333;
        }
        .article-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        h1 {
            font-size: 2.2em;
            margin-bottom: 20px;
        }
        .meta {
            color: #666;
            margin-bottom: 30px;
            font-size: 0.9em;
        }
        p {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="article-container">
        <h1>ÊñáÁ´†Ê®ôÈ°å</h1>
        <div class="meta">
            ‰ΩúËÄÖÔºö‰ΩúËÄÖÂêçÁ®± | ÁôºÂ∏ÉÊó•ÊúüÔºö2025Âπ¥3Êúà24Êó•
        </div>
        <article>
            <p>ÈÄôÊòØÊñáÁ´†ÁöÑÁ¨¨‰∏ÄÊÆµ„ÄÇ‰Ω†ÂèØ‰ª•Âú®ÈÄôË£°ÂØ´ÂÖ•ÂÖßÂÆπ„ÄÇ</p>
            <p>ÈÄôÊòØÊñáÁ´†ÁöÑÁ¨¨‰∫åÊÆµ„ÄÇÁπºÁ∫åÂØ´ÂÖ•Êõ¥Â§öÂÖßÂÆπ„ÄÇ</p>
            <h2>Â∞èÊ®ôÈ°å</h2>
            <p>ÈÄôÊòØÂ∞èÊ®ôÈ°å‰∏ãÁöÑÂÖßÂÆπ„ÄÇ</p>
        </article>
    </div>
</body>
</html>`
                }
            ];
            
            const templateNames = templates.map(t => t.name);
            const selectedTemplate = prompt(`Ë´ãÈÅ∏Êìá‰∏ÄÂÄãÊ®°Êùø:\n${templateNames.map((name, index) => `${index + 1}. ${name}`).join('\n')}\n\nËº∏ÂÖ•Á∑®Ëôü:`);
            
            if (selectedTemplate && !isNaN(selectedTemplate) && selectedTemplate <= templates.length) {
                const index = parseInt(selectedTemplate) - 1;
                document.getElementById('htmlInput').value = templates[index].code;
                updatePreview();
                document.getElementById('customName').value = templates[index].name.replace(/[^a-zA-Z0-9\u4e00-\u9fa5\-_]/g, '_');
                updateStatus(`Â∑≤ËºâÂÖ•Ê®°Êùø: ${templates[index].name}`);
            }
        }

        // ÂàùÂßãÂåñ‰ª£Á¢ºÁõ£ËÅΩÂô®
        document.getElementById('htmlInput').addEventListener('input', () => {
            clearTimeout(window.previewTimeout);
            window.previewTimeout = setTimeout(updatePreview, 500);
        });
    </script>
</body>
</html>
